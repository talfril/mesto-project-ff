(()=>{"use strict";var e,t=document.querySelectorAll(".popup");function r(t){t.classList.add("popup_is-opened"),e=function(e){!function(e,t){"Escape"===e.key&&n(t)}(e,t)},document.addEventListener("keydown",e)}function n(t){t.classList.remove("popup_is-opened"),document.removeEventListener("keydown",e)}var o,a=document.querySelector(".popup_type_image"),c=a.querySelector(".popup__image"),i=a.querySelector(".popup__caption");function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l="https://nomoreparties.co/v1/wff-cohort-2",s={headers:{authorization:"c1324e8c-3ffd-41bf-8d8d-d39bc9277f92","Content-Type":"application/json"}};function d(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}function p(e,t){return fetch(e,t).then(d)}function f(e){return p("".concat(l,"/cards/likes/").concat(e),{method:"PUT",headers:s.headers,body:JSON.stringify({})})}function y(e){return p("".concat(l,"/cards/likes/").concat(e),{method:"DELETE",headers:s.headers,body:JSON.stringify({})})}function _(e,t){if(t&&t.classList.contains("popup__button")){var r=e?"Сохранение...":"Сохранить";t.textContent=r}}var m={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible",errorSelector:function(e){return"[data-error-for='".concat(e,"']")}},v=function(e,t,r){var n=e.querySelector(r.errorSelector(t.id));n&&(t.classList.remove(r.inputErrorClass),n.classList.remove(r.errorClass),n.textContent="")};function h(e,t){var r=Array.from(e.querySelectorAll(t.inputSelector)),n=e.querySelector(t.submitButtonSelector);b(r,n,t),r.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,r){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?v(e,t,r):function(e,t,r,n){var o=e.querySelector(n.errorSelector(t.id));o&&(t.classList.add(n.inputErrorClass),o.textContent=r,o.classList.add(n.errorClass))}(e,t,t.validationMessage,r)}(e,o,t),b(r,n,t)}))}))}function S(e,t){Array.from(e.querySelectorAll(t.inputSelector)).forEach((function(r){v(e,r,t)}));var r=e.querySelector(t.submitButtonSelector);r.classList.add(t.inactiveButtonClass),r.setAttribute("disabled",!0)}function b(e,t,r){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(r.inactiveButtonClass),t.removeAttribute("disabled")):(t.classList.add(r.inactiveButtonClass),t.setAttribute("disabled",!0))}var q=document.querySelector(".places__list"),g=document.querySelector(".popup_type_new-card"),E=document.querySelector("#card-template").content,k=document.forms.newPlace,C=k.querySelector(".popup__input_type_card-name"),L=k.querySelector(".popup__input_type_url");function A(e,t,n,o){var u=E.querySelector(".card").cloneNode(!0),l=u.querySelector(".card__delete-button"),s=u.querySelector(".card__image"),d=u.querySelector(".card__title"),p=u.querySelector(".card__like-button"),f=u.querySelector(".likes-number"),y=e._id||"";return u.dataset.cardId=y,e.owner&&e.owner._id===o?l.style.display="block":l.style.display="none",e.likes&&e.likes.some((function(e){return e._id===o}))&&p.classList.add("card__like-button_is-active"),s.src=e.link,s.alt="Фотография с места - "+e.name,d.textContent=e.name,f.textContent=e.likes.length,l.addEventListener("click",t),p.addEventListener("click",(function(){n(y)})),s.addEventListener("click",(function(){var t,n;t=e.link,n=e.name,c.src=t,c.alt=n,i.textContent=n,r(a)})),u}function w(e){var t,r=e.target.closest(".card");(t=r.dataset.cardId,p("".concat(l,"/cards/").concat(t),{method:"DELETE",headers:s.headers})).then((function(){r.remove()})).catch((function(e){console.log("Ошибка: ".concat(e))}))}function x(e){var t=document.querySelector(".card[data-card-id='".concat(e,"']")),r=t.querySelector(".card__like-button"),n=r.classList.contains("card__like-button_is-active");(n?y:f)(e).then((function(e){r.classList.toggle("card__like-button_is-active"),t.querySelector(".likes-number").textContent=e.likes.length,t.dataset.isLiked=n?"false":"true"})).catch((function(e){console.log("Ошибка при обработке лайка/дизлайка: ".concat(e))}))}var D=document.querySelector(".popup_type_edit"),O=document.querySelector(".profile__edit-button"),P=document.querySelector(".profile__add-button"),T=document.querySelector(".profile__title"),j=document.querySelector(".profile__description"),B=document.forms.editProfile,I=B.querySelector(".popup__input_type_name"),N=B.querySelector(".popup__input_type_description");function J(){I.value=T.textContent,N.value=j.textContent;var e=new Event("input",{bubbles:!0});I.dispatchEvent(e),N.dispatchEvent(e)}O.addEventListener("click",(function(){J(),r(D)})),J();var M,H=document.querySelector(".profile__image"),U=document.querySelector(".profile__image"),V=document.querySelector(".popup_type_new-avatar"),z=document.forms.changeAvatar,$=z.querySelector(".popup__input_type_avatar_url");U.addEventListener("click",(function(){r(V)})),B.addEventListener("submit",(function(e){e.preventDefault();var t,r,o=e.target.querySelector(".popup__button");_(!0,o),(t=I.value,r=N.value,p("".concat(l,"/users/me"),{method:"PATCH",headers:s.headers,body:JSON.stringify({name:t,about:r})})).then((function(){T.textContent=I.value,j.textContent=N.value,n(D),B.reset()})).catch((function(e){console.log("Ошибка: ".concat(e))})).finally((function(){_(!1,o)}))})),newPlace.addEventListener("submit",(function(e){e.preventDefault();var t,r,a=e.submitter;_(!0,a),(t=C.value,r=L.value,p("".concat(l,"/cards"),{method:"POST",headers:s.headers,body:JSON.stringify({name:t,link:r})})).then((function(e){var t=A(e,w,x,o);q.insertBefore(t,q.firstChild),k.reset(),S(k,m),h(k,m),n(g)})).catch((function(e){console.error("Ошибка при добавлении карточки:",e)})).finally((function(){_(!1,a)}))})),z.addEventListener("submit",(function(e){e.preventDefault();var t=z.querySelector(".popup__button"),r=$.value;_(!0,t),function(e){return p("".concat(l,"/users/me/avatar"),{method:"PATCH",headers:s.headers,body:JSON.stringify({avatar:e})})}(r).then((function(){H.style.backgroundImage="url('".concat(r,"')"),n(V),z.reset(),S(z,m),h(z,m)})).catch((function(e){console.error("Ошибка при сохранении аватара:",e)})).finally((function(){_(!1,t)}))})),t.forEach((function(e){e.addEventListener("click",(function(t){(t.target===t.currentTarget||t.target.classList.contains("popup__close"))&&n(e)}))})),M=g,P.addEventListener("click",(function(){r(M)})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),h(t,e)}))}(m),Promise.all([p("".concat(l,"/users/me"),{headers:s.headers}).then((function(e){return o=e._id,{name:e.name,about:e.about,avatar:"url('".concat(e.avatar,"')"),_id:o}})),p("".concat(l,"/cards"),{headers:s.headers}).then((function(e){return Array.from(e)}))]).then((function(e){var t,r,n=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,c,i=[],u=!0,l=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(i.push(n.value),i.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(c=r.return(),Object(c)!==c))return}finally{if(l)throw o}}return i}}(t,r)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{userData:n[0],cardsData:n[1]}})).then((function(e){var t=e.userData,r=e.cardsData;T.textContent=t.name,j.textContent=t.about,H.style.backgroundImage=t.avatar,function(e){e.forEach((function(e){var t=A(e,w,x,o);q.appendChild(t)}))}(r)})).catch((function(e){console.error("Ошибка при получении данных пользователя:",e)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bkNvQixFQUFtQnBGLFlBQWM4SCxFQUFTdEIsTUFDMUNULEVBQWF0QyxNQUFNNkQsZ0JBQWtCUSxFQUFTVixPRHhDM0MsU0FBa0JXLEdBQ3ZCQSxFQUFVMUcsU0FBUSxTQUFVd0IsR0FDMUIsSUFBTW1GLEVBQU9wRixFQUFXQyxFQUFPcUIsRUFBWVEsRUFBVTVHLEdBQ3JEc0UsRUFBWTZGLFlBQVlELEVBQzFCLEdBQ0YsQ0NxQ0lFLENBQVNILEVBQ1gsSUFDQ3pELE9BQU0sU0FBQzRDLEdBQ04xQyxRQUFRMEMsTUFBTSw0Q0FBNkNBLEVBQzdELEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly95YW5kZXhfcHJha3Rpa3VtLy4vc3JjL3NjcmlwdHMvbW9kYWwuanMiLCJ3ZWJwYWNrOi8veWFuZGV4X3ByYWt0aWt1bS8uL3NyYy9zY3JpcHRzL2FwaS5qcyIsIndlYnBhY2s6Ly95YW5kZXhfcHJha3Rpa3VtLy4vc3JjL3NjcmlwdHMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8veWFuZGV4X3ByYWt0aWt1bS8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8veWFuZGV4X3ByYWt0aWt1bS8uL3NyYy9zY3JpcHRzL2NhcmQuanMiLCJ3ZWJwYWNrOi8veWFuZGV4X3ByYWt0aWt1bS8uL3NyYy9zY3JpcHRzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBwb3B1cHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXAnKTtcclxubGV0IGVzY0NhbGxiYWNrO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5Qb3B1cChwb3B1cCkge1xyXG4gIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX2lzLW9wZW5lZCcpO1xyXG4gIGVzY0NhbGxiYWNrID0gZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgY2xvc2VQb3BhcEVzYyhldnQsIHBvcHVwKTtcclxuICB9O1xyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlc2NDYWxsYmFjayk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjbG9zZVBvcHVwKHBvcHVwKSB7XHJcbiAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfaXMtb3BlbmVkJyk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGVzY0NhbGxiYWNrKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VQb3BhcEVzYyhldnQsIHBvcHVwKSB7XHJcbiAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XHJcbiAgICBjbG9zZVBvcHVwKHBvcHVwKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBvcGVuUG9wdXBCeUJ1dHRvbihidXR0b24sIHBvcHVwKSB7XHJcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgb3BlblBvcHVwKHBvcHVwKTtcclxuICB9KTtcclxufVxyXG5cclxuLy/QvtGC0LrRgNGL0YLQuNC1INC/0L7Qv9Cw0L/QsCDQuNC30L7QsdGA0LDQttC10L3QuNGPXHJcbmNvbnN0IHBvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9pbWFnZScpO1xyXG5jb25zdCBwb3B1cEltYWdlSW1hZ2UgPSBwb3B1cEltYWdlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcclxuY29uc3QgcG9wdXBJbWFnZUNhcHRpb24gPSBwb3B1cEltYWdlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2FwdGlvbicpO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5JbWFnZVBvcHVwKGxpbmssIGFsdCkge1xyXG4gIHBvcHVwSW1hZ2VJbWFnZS5zcmMgPSBsaW5rO1xyXG4gIHBvcHVwSW1hZ2VJbWFnZS5hbHQgPSBhbHQ7XHJcbiAgcG9wdXBJbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBhbHQ7XHJcbiAgb3BlblBvcHVwKHBvcHVwSW1hZ2UpO1xyXG59XHJcbiIsImV4cG9ydCBsZXQgY3VycmVudFVzZXJJZDtcclxuY29uc3QgYmFzZVVybCA9ICdodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2ZmLWNvaG9ydC0yJztcclxuY29uc3QgYXV0aG9yaXphdGlvblRva2VuID0gJ2MxMzI0ZThjLTNmZmQtNDFiZi04ZDhkLWQzOWJjOTI3N2Y5Mic7XHJcblxyXG5jb25zdCBjb25maWcgPSB7XHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogYXV0aG9yaXphdGlvblRva2VuLFxyXG4gICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICB9LFxyXG59O1xyXG5cclxuZnVuY3Rpb24gY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICBpZiAoIXJlcy5vaykge1xyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcbiAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlcXVlc3QodXJsLCBvcHRpb25zKSB7XHJcbiAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbihjaGVja1Jlc3BvbnNlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGF1dGhvcml6ZVVzZXIoKSB7XHJcbiAgcmV0dXJuIHJlcXVlc3QoYCR7YmFzZVVybH0vdXNlcnMvbWVgLCB7IGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzIH0pLnRoZW4oXHJcbiAgICAocmVzdWx0KSA9PiB7XHJcbiAgICAgIGN1cnJlbnRVc2VySWQgPSByZXN1bHQuX2lkO1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxyXG4gICAgICAgIGFib3V0OiByZXN1bHQuYWJvdXQsXHJcbiAgICAgICAgYXZhdGFyOiBgdXJsKCcke3Jlc3VsdC5hdmF0YXJ9JylgLFxyXG4gICAgICAgIF9pZDogY3VycmVudFVzZXJJZCxcclxuICAgICAgfTtcclxuICAgIH1cclxuICApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2FyZHNGcm9tU2VydmVyKCkge1xyXG4gIHJldHVybiByZXF1ZXN0KGAke2Jhc2VVcmx9L2NhcmRzYCwgeyBoZWFkZXJzOiBjb25maWcuaGVhZGVycyB9KS50aGVuKFxyXG4gICAgKHJlc3VsdCkgPT4ge1xyXG4gICAgICBjb25zdCBpbml0aWFsQ2FyZHNGcm9tU2VydmVyID0gQXJyYXkuZnJvbShyZXN1bHQpO1xyXG4gICAgICByZXR1cm4gaW5pdGlhbENhcmRzRnJvbVNlcnZlcjtcclxuICAgIH1cclxuICApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcHVzaE15QXV0aG9yaXphdGlvblRvU2VydmVyKG5hbWUsIGRlc2NyaXB0aW9uKSB7XHJcbiAgcmV0dXJuIHJlcXVlc3QoYCR7YmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgYWJvdXQ6IGRlc2NyaXB0aW9uLFxyXG4gICAgfSksXHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwdXNoTXlDYXJkVG9TZXJ2ZXIoY2FyZE5hbWUsIGNhcmRMaW5rKSB7XHJcbiAgcmV0dXJuIHJlcXVlc3QoYCR7YmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICBuYW1lOiBjYXJkTmFtZSxcclxuICAgICAgbGluazogY2FyZExpbmssXHJcbiAgICB9KSxcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZUNhcmRPblNlcnZlcihjYXJkSWQpIHtcclxuICByZXR1cm4gcmVxdWVzdChgJHtiYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBsaWtlQ2FyZE9uU2VydmVyKGNhcmRJZCkge1xyXG4gIHJldHVybiByZXF1ZXN0KGAke2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHt9KSxcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRpc0xpa2VDYXJkT25TZXJ2ZXIoY2FyZElkKSB7XHJcbiAgcmV0dXJuIHJlcXVlc3QoYCR7YmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe30pLFxyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlVXNlckF2YXRhcihhdmF0YXJVcmwpIHtcclxuICByZXR1cm4gcmVxdWVzdChgJHtiYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgYXZhdGFyOiBhdmF0YXJVcmwsXHJcbiAgICB9KSxcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGZldGNoVXNlckRhdGFBbmRDYXJkcygpIHtcclxuICByZXR1cm4gUHJvbWlzZS5hbGwoW2F1dGhvcml6ZVVzZXIoKSwgZ2V0Q2FyZHNGcm9tU2VydmVyKCldKS50aGVuKFxyXG4gICAgKFt1c2VyRGF0YSwgY2FyZHNEYXRhXSkgPT4ge1xyXG4gICAgICByZXR1cm4geyB1c2VyRGF0YSwgY2FyZHNEYXRhIH07XHJcbiAgICB9XHJcbiAgKTtcclxufVxyXG4iLCJleHBvcnQgZnVuY3Rpb24gcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGJ1dHRvbikge1xyXG4gICAgaWYgKGJ1dHRvbiAmJiBidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fYnV0dG9uJykpIHtcclxuICAgICAgY29uc3QgYnV0dG9uVGV4dCA9IGlzTG9hZGluZyA/ICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLicgOiAn0KHQvtGF0YDQsNC90LjRgtGMJztcclxuICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gYnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9IiwiZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiAnLnBvcHVwX19mb3JtJyxcclxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX2J1dHRvbicsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19idXR0b25fZGlzYWJsZWQnLFxyXG4gIGlucHV0RXJyb3JDbGFzczogJ3BvcHVwX19pbnB1dF90eXBlX2Vycm9yJyxcclxuICBlcnJvckNsYXNzOiAncG9wdXBfX2Vycm9yX3Zpc2libGUnLFxyXG4gIGVycm9yU2VsZWN0b3I6IChpbnB1dElkKSA9PiBgW2RhdGEtZXJyb3ItZm9yPScke2lucHV0SWR9J11gLFxyXG59O1xyXG5cclxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoXHJcbiAgZm9ybUVsZW1lbnQsXHJcbiAgaW5wdXRFbGVtZW50LFxyXG4gIGVycm9yTWVzc2FnZSxcclxuICB2YWxpZGF0aW9uQ29uZmlnXHJcbikgPT4ge1xyXG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICB2YWxpZGF0aW9uQ29uZmlnLmVycm9yU2VsZWN0b3IoaW5wdXRFbGVtZW50LmlkKVxyXG4gICk7XHJcbiAgaWYgKGVycm9yRWxlbWVudCkge1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodmFsaWRhdGlvbkNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodmFsaWRhdGlvbkNvbmZpZy5lcnJvckNsYXNzKTtcclxuICB9XHJcbn07XHJcblxyXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgIHZhbGlkYXRpb25Db25maWcuZXJyb3JTZWxlY3RvcihpbnB1dEVsZW1lbnQuaWQpXHJcbiAgKTtcclxuICBpZiAoZXJyb3JFbGVtZW50KSB7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh2YWxpZGF0aW9uQ29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh2YWxpZGF0aW9uQ29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XHJcbiAgfVxyXG59O1xyXG5cclxuZnVuY3Rpb24gY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpIHtcclxuICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnBhdHRlcm5NaXNtYXRjaCkge1xyXG4gICAgaW5wdXRFbGVtZW50LnNldEN1c3RvbVZhbGlkaXR5KGlucHV0RWxlbWVudC5kYXRhc2V0LmVycm9yTWVzc2FnZSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGlucHV0RWxlbWVudC5zZXRDdXN0b21WYWxpZGl0eSgnJyk7XHJcbiAgfVxyXG5cclxuICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoXHJcbiAgICAgIGZvcm1FbGVtZW50LFxyXG4gICAgICBpbnB1dEVsZW1lbnQsXHJcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcclxuICAgICAgdmFsaWRhdGlvbkNvbmZpZ1xyXG4gICAgKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpIHtcclxuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh2YWxpZGF0aW9uQ29uZmlnLmlucHV0U2VsZWN0b3IpXHJcbiAgKTtcclxuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgIHZhbGlkYXRpb25Db25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICApO1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goZnVuY3Rpb24gKGlucHV0RWxlbWVudCkge1xyXG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvbkNvbmZpZykge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodmFsaWRhdGlvbkNvbmZpZy5mb3JtU2VsZWN0b3IpXHJcbiAgKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChmb3JtRWxlbWVudCkge1xyXG4gICAgZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVmFsaWRhdGlvbihmb3JtRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZykge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25Db25maWcuaW5wdXRTZWxlY3RvcilcclxuICApO1xyXG5cclxuICBpbnB1dExpc3QuZm9yRWFjaChmdW5jdGlvbiAoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICB9KTtcclxuXHJcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICB2YWxpZGF0aW9uQ29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgKTtcclxuICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodmFsaWRhdGlvbkNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICBidXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCB0cnVlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZShmdW5jdGlvbiAoaW5wdXRFbGVtZW50KSB7XHJcbiAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKSB7XHJcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodmFsaWRhdGlvbkNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIGJ1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsIHRydWUpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodmFsaWRhdGlvbkNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIGJ1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBjbG9zZVBvcHVwLCBvcGVuSW1hZ2VQb3B1cCB9IGZyb20gJy4vbW9kYWwuanMnO1xyXG5pbXBvcnQge1xyXG4gIHB1c2hNeUNhcmRUb1NlcnZlcixcclxuICBjdXJyZW50VXNlcklkLFxyXG4gIGRlbGV0ZUNhcmRPblNlcnZlcixcclxuICBsaWtlQ2FyZE9uU2VydmVyLFxyXG4gIGRpc0xpa2VDYXJkT25TZXJ2ZXIsXHJcbn0gZnJvbSAnLi9hcGkuanMnO1xyXG5pbXBvcnQgeyByZW5kZXJMb2FkaW5nIH0gZnJvbSAnLi91dGlscy5qcyc7XHJcbmltcG9ydCB7XHJcbiAgdmFsaWRhdGlvbkNvbmZpZyxcclxuICBzZXRFdmVudExpc3RlbmVycyxcclxuICBjbGVhclZhbGlkYXRpb24sXHJcbn0gZnJvbSAnLi92YWxpZGF0aW9uLmpzJztcclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkc09uUGFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZXNfX2xpc3QnKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwQWRkTmV3Q2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX25ldy1jYXJkJyk7XHJcblxyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2FyZC10ZW1wbGF0ZScpLmNvbnRlbnQ7XHJcbmNvbnN0IG5ld1BsYWNlID0gZG9jdW1lbnQuZm9ybXMubmV3UGxhY2U7XHJcbmNvbnN0IHBsYWNlTmFtZSA9IG5ld1BsYWNlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9jYXJkLW5hbWUnKTtcclxuY29uc3QgcGxhY2VMaW5rID0gbmV3UGxhY2UucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX3VybCcpO1xyXG5cclxuLy8g0KTRg9C90LrRhtC40Y8g0YHQvtC30LTQsNC90LjRjyDQutCw0YDRgtC+0YfQutC4XHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQocGxhY2UsIGRlbGV0ZUZ1bmN0aW9uLCBsaWtlRnVuY3Rpb24sIGN1cnJlbnRVc2VySWQpIHtcclxuICBjb25zdCBjYXJkSXRlbSA9IGNhcmRUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKCcuY2FyZCcpLmNsb25lTm9kZSh0cnVlKTtcclxuICBjb25zdCBkZWxldGVCdXR0b24gPSBjYXJkSXRlbS5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ1dHRvbicpO1xyXG4gIGNvbnN0IGNhcmRJbWFnZSA9IGNhcmRJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpO1xyXG4gIGNvbnN0IGNhcmRUaXRsZSA9IGNhcmRJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpO1xyXG4gIGNvbnN0IGNhcmRMaWtlQnV0dG9uID0gY2FyZEl0ZW0ucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJyk7XHJcbiAgY29uc3QgbnVtYmVyT2ZMaWtlcyA9IGNhcmRJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5saWtlcy1udW1iZXInKTtcclxuXHJcbiAgY29uc3QgY2FyZElkID0gcGxhY2UuX2lkIHx8ICcnO1xyXG4gIGNhcmRJdGVtLmRhdGFzZXQuY2FyZElkID0gY2FyZElkO1xyXG5cclxuICBpZiAocGxhY2Uub3duZXIgJiYgcGxhY2Uub3duZXIuX2lkID09PSBjdXJyZW50VXNlcklkKSB7XHJcbiAgICBkZWxldGVCdXR0b24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgfSBlbHNlIHtcclxuICAgIGRlbGV0ZUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gIH1cclxuICBpZiAocGxhY2UubGlrZXMgJiYgcGxhY2UubGlrZXMuc29tZSgodXNlcikgPT4gdXNlci5faWQgPT09IGN1cnJlbnRVc2VySWQpKSB7XHJcbiAgICBjYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmUnKTtcclxuICB9XHJcbiAgY2FyZEltYWdlLnNyYyA9IHBsYWNlLmxpbms7XHJcbiAgY2FyZEltYWdlLmFsdCA9ICfQpNC+0YLQvtCz0YDQsNGE0LjRjyDRgSDQvNC10YHRgtCwIC0gJyArIHBsYWNlLm5hbWU7XHJcbiAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gcGxhY2UubmFtZTtcclxuICBudW1iZXJPZkxpa2VzLnRleHRDb250ZW50ID0gcGxhY2UubGlrZXMubGVuZ3RoO1xyXG4gIGRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGRlbGV0ZUZ1bmN0aW9uKTtcclxuICBjYXJkTGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgIGxpa2VGdW5jdGlvbihjYXJkSWQpO1xyXG4gIH0pO1xyXG4gIGNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgIG9wZW5JbWFnZVBvcHVwKHBsYWNlLmxpbmssIHBsYWNlLm5hbWUpO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gY2FyZEl0ZW07XHJcbn1cclxuXHJcbi8vINCk0YPQvdC60YbQuNGPINGD0LTQsNC70LXQvdC40Y8g0LrQsNGA0YLQvtGH0LrQuFxyXG5mdW5jdGlvbiBkZWxldGVDYXJkKGV2dCkge1xyXG4gIGNvbnN0IGNhcmRUb1JlbW92ZSA9IGV2dC50YXJnZXQuY2xvc2VzdCgnLmNhcmQnKTtcclxuICBjb25zdCBjYXJkSWQgPSBjYXJkVG9SZW1vdmUuZGF0YXNldC5jYXJkSWQ7XHJcbiAgZGVsZXRlQ2FyZE9uU2VydmVyKGNhcmRJZClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgY2FyZFRvUmVtb3ZlLnJlbW92ZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7ZXJyfWApO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vINCk0YPQvdC60YbQuNGPINC70LDQudC60LAv0LTQuNC30LvQsNC50LrQsCDQutCw0YDRgtC+0YfQutC4XHJcbmV4cG9ydCBmdW5jdGlvbiBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICBjb25zdCBjdXJyZW50Q2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5jYXJkW2RhdGEtY2FyZC1pZD0nJHtjYXJkSWR9J11gKTtcclxuICBjb25zdCBjYXJkVG9MaWtlID0gY3VycmVudENhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJyk7XHJcbiAgY29uc3QgaXNMaWtlZCA9IGNhcmRUb0xpa2UuY2xhc3NMaXN0LmNvbnRhaW5zKCdjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmUnKTtcclxuICBjb25zdCBsaWtlQWN0aW9uID0gaXNMaWtlZCA/IGRpc0xpa2VDYXJkT25TZXJ2ZXIgOiBsaWtlQ2FyZE9uU2VydmVyO1xyXG4gIGxpa2VBY3Rpb24oY2FyZElkKVxyXG4gICAgLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XHJcbiAgICAgIGNhcmRUb0xpa2UuY2xhc3NMaXN0LnRvZ2dsZSgnY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlJyk7XHJcbiAgICAgIGNvbnN0IGxpa2VzTnVtYmVyRWxlbWVudCA9IGN1cnJlbnRDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5saWtlcy1udW1iZXInKTtcclxuICAgICAgbGlrZXNOdW1iZXJFbGVtZW50LnRleHRDb250ZW50ID0gdXBkYXRlZENhcmQubGlrZXMubGVuZ3RoO1xyXG4gICAgICBjdXJyZW50Q2FyZC5kYXRhc2V0LmlzTGlrZWQgPSBpc0xpa2VkID8gJ2ZhbHNlJyA6ICd0cnVlJztcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwINC/0YDQuCDQvtCx0YDQsNCx0L7RgtC60LUg0LvQsNC50LrQsC/QtNC40LfQu9Cw0LnQutCwOiAke2Vycn1gKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyDQktGL0LLQtdGB0YLQuCDQutCw0YDRgtC+0YfQutC4INC90LAg0YHRgtGA0LDQvdC40YbRg1xyXG5leHBvcnQgZnVuY3Rpb24gYWRkQ2FyZHMoY2FyZHNEYXRhKSB7XHJcbiAgY2FyZHNEYXRhLmZvckVhY2goZnVuY3Rpb24gKHBsYWNlKSB7XHJcbiAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChwbGFjZSwgZGVsZXRlQ2FyZCwgbGlrZUNhcmQsIGN1cnJlbnRVc2VySWQpO1xyXG4gICAgY2FyZHNPblBhZ2UuYXBwZW5kQ2hpbGQoY2FyZCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vINCU0L7QsdCw0LLQu9C10L3QuNC1INC90L7QstC+0Lkg0LrQsNGA0YLQvtGH0LrQuCDRh9C10YDQtdC3INC/0L7Qv9Cw0L9cclxuZXhwb3J0IGZ1bmN0aW9uIGFkZENhcmRUb0NhcmRzQXJyYXkoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGV2dC5zdWJtaXR0ZXI7XHJcbiAgcmVuZGVyTG9hZGluZyh0cnVlLCBzYXZlQnV0dG9uKTtcclxuICBwdXNoTXlDYXJkVG9TZXJ2ZXIocGxhY2VOYW1lLnZhbHVlLCBwbGFjZUxpbmsudmFsdWUpXHJcbiAgICAudGhlbigoYWRkZWRDYXJkKSA9PiB7XHJcbiAgICAgIGNvbnN0IG5ld1BsYWNlQ2FyZCA9IGNyZWF0ZUNhcmQoXHJcbiAgICAgICAgYWRkZWRDYXJkLFxyXG4gICAgICAgIGRlbGV0ZUNhcmQsXHJcbiAgICAgICAgbGlrZUNhcmQsXHJcbiAgICAgICAgY3VycmVudFVzZXJJZFxyXG4gICAgICApO1xyXG4gICAgICBjYXJkc09uUGFnZS5pbnNlcnRCZWZvcmUobmV3UGxhY2VDYXJkLCBjYXJkc09uUGFnZS5maXJzdENoaWxkKTtcclxuICAgICAgbmV3UGxhY2UucmVzZXQoKTtcclxuICAgICAgY2xlYXJWYWxpZGF0aW9uKG5ld1BsYWNlLCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICAgICAgc2V0RXZlbnRMaXN0ZW5lcnMobmV3UGxhY2UsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gICAgICBjbG9zZVBvcHVwKHBvcHVwQWRkTmV3Q2FyZCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCfQntGI0LjQsdC60LAg0L/RgNC4INC00L7QsdCw0LLQu9C10L3QuNC4INC60LDRgNGC0L7Rh9C60Lg6JywgZXJyb3IpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcmVuZGVyTG9hZGluZyhmYWxzZSwgc2F2ZUJ1dHRvbik7XHJcbiAgICB9KTtcclxufVxyXG4iLCJpbXBvcnQgJy4uL3BhZ2VzL2luZGV4LmNzcyc7XHJcbmltcG9ydCB7IGFkZENhcmRzLCBhZGRDYXJkVG9DYXJkc0FycmF5LCBwb3B1cEFkZE5ld0NhcmQgfSBmcm9tICcuL2NhcmQuanMnO1xyXG5pbXBvcnQgeyBvcGVuUG9wdXAsIGNsb3NlUG9wdXAsIG9wZW5Qb3B1cEJ5QnV0dG9uLCBwb3B1cHMgfSBmcm9tICcuL21vZGFsLmpzJztcclxuaW1wb3J0IHtcclxuICBlbmFibGVWYWxpZGF0aW9uLFxyXG4gIHZhbGlkYXRpb25Db25maWcsXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMsXHJcbiAgY2xlYXJWYWxpZGF0aW9uLFxyXG59IGZyb20gJy4vdmFsaWRhdGlvbi5qcyc7XHJcbmltcG9ydCB7XHJcbiAgcHVzaE15QXV0aG9yaXphdGlvblRvU2VydmVyLFxyXG4gIHVwZGF0ZVVzZXJBdmF0YXIsXHJcbiAgZmV0Y2hVc2VyRGF0YUFuZENhcmRzLFxyXG59IGZyb20gJy4vYXBpLmpzJztcclxuaW1wb3J0IHsgcmVuZGVyTG9hZGluZyB9IGZyb20gJy4vdXRpbHMuanMnO1xyXG5cclxuY29uc3QgcG9wdXBQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfZWRpdCcpO1xyXG5jb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnV0dG9uJyk7XHJcbmNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XHJcblxyXG4vLyDQkdC70L7QuiDQvtGC0LLQtdGH0LDRjtGJ0LjQuSDQt9CwINGB0L7RhdGA0LDQvdC10L3QuNC1INC00LDQvdC90YvRhSDQsiBwb3B1cCAn0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjQtSDQv9GA0L7RhNC40LvRjydcclxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fdGl0bGUnKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2Rlc2NyaXB0aW9uJyk7XHJcbmNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXMuZWRpdFByb2ZpbGU7XHJcbmNvbnN0IHByb2ZpbGVGb3JtTmFtZSA9IHByb2ZpbGVGb3JtLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9uYW1lJyk7XHJcbmNvbnN0IHByb2ZpbGVGb3JtRGVzY3JpcHRpb24gPSBwcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICcucG9wdXBfX2lucHV0X3R5cGVfZGVzY3JpcHRpb24nXHJcbik7XHJcblxyXG5mdW5jdGlvbiBzZXRQcm9maWxlRm9ybVZhbHVlcygpIHtcclxuICBwcm9maWxlRm9ybU5hbWUudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcclxuICBwcm9maWxlRm9ybURlc2NyaXB0aW9uLnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xyXG4gIGNvbnN0IGlucHV0RXZlbnQgPSBuZXcgRXZlbnQoJ2lucHV0JywgeyBidWJibGVzOiB0cnVlIH0pO1xyXG4gIHByb2ZpbGVGb3JtTmFtZS5kaXNwYXRjaEV2ZW50KGlucHV0RXZlbnQpO1xyXG4gIHByb2ZpbGVGb3JtRGVzY3JpcHRpb24uZGlzcGF0Y2hFdmVudChpbnB1dEV2ZW50KTtcclxufVxyXG5cclxuZnVuY3Rpb24gb3BlblByb2ZpbGVQb3B1cEJ5QnV0dG9uKCkge1xyXG4gIHNldFByb2ZpbGVGb3JtVmFsdWVzKCk7XHJcbiAgb3BlblBvcHVwKHBvcHVwUHJvZmlsZSk7XHJcbn1cclxuXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuUHJvZmlsZVBvcHVwQnlCdXR0b24pO1xyXG5cclxuLy8g0JjQt9C80LXQvdC10L3QuNC1INC/0YDQvtGE0LjQu9GPXHJcbmZ1bmN0aW9uIGNoYW5nZVByb2ZpbGUoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGV2dC50YXJnZXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcclxuICByZW5kZXJMb2FkaW5nKHRydWUsIHNhdmVCdXR0b24pO1xyXG5cclxuICBwdXNoTXlBdXRob3JpemF0aW9uVG9TZXJ2ZXIoXHJcbiAgICBwcm9maWxlRm9ybU5hbWUudmFsdWUsXHJcbiAgICBwcm9maWxlRm9ybURlc2NyaXB0aW9uLnZhbHVlXHJcbiAgKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHByb2ZpbGVGb3JtTmFtZS52YWx1ZTtcclxuICAgICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gcHJvZmlsZUZvcm1EZXNjcmlwdGlvbi52YWx1ZTtcclxuICAgICAgY2xvc2VQb3B1cChwb3B1cFByb2ZpbGUpO1xyXG4gICAgICBwcm9maWxlRm9ybS5yZXNldCgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7ZXJyfWApO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcmVuZGVyTG9hZGluZyhmYWxzZSwgc2F2ZUJ1dHRvbik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuc2V0UHJvZmlsZUZvcm1WYWx1ZXMoKTtcclxuXHJcbi8v0JjQt9C80LXQvdC10L3QuNC1INCw0LLQsNGC0LDRgNCwINGH0LXRgNC10Lcg0L/QvtC/0LDQv1xyXG5jb25zdCBwcm9maWxlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faW1hZ2UnKTtcclxuY29uc3QgY2hhbmdlQXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlJyk7XHJcbmNvbnN0IHBvcHVwQ2hhbmdlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfbmV3LWF2YXRhcicpO1xyXG5jb25zdCBhdmF0YXJGb3JtID0gZG9jdW1lbnQuZm9ybXMuY2hhbmdlQXZhdGFyO1xyXG5jb25zdCBjaGFuZ2VBdmF0YXJGb3JtID0gYXZhdGFyRm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICcucG9wdXBfX2lucHV0X3R5cGVfYXZhdGFyX3VybCdcclxuKTtcclxuXHJcbmNoYW5nZUF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICBvcGVuUG9wdXAocG9wdXBDaGFuZ2VBdmF0YXIpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGNoYW5nZVByb2ZpbGVBdmF0YXIoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGF2YXRhckZvcm0ucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcclxuICBjb25zdCBhdmF0YXJVcmwgPSBjaGFuZ2VBdmF0YXJGb3JtLnZhbHVlO1xyXG4gIHJlbmRlckxvYWRpbmcodHJ1ZSwgc2F2ZUJ1dHRvbik7XHJcblxyXG4gIHVwZGF0ZVVzZXJBdmF0YXIoYXZhdGFyVXJsKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBwcm9maWxlSW1hZ2Uuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgnJHthdmF0YXJVcmx9JylgO1xyXG4gICAgICBjbG9zZVBvcHVwKHBvcHVwQ2hhbmdlQXZhdGFyKTtcclxuICAgICAgYXZhdGFyRm9ybS5yZXNldCgpO1xyXG4gICAgICBjbGVhclZhbGlkYXRpb24oYXZhdGFyRm9ybSwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgICAgIHNldEV2ZW50TGlzdGVuZXJzKGF2YXRhckZvcm0sIHZhbGlkYXRpb25Db25maWcpOyBcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ9Ce0YjQuNCx0LrQsCDQv9GA0Lgg0YHQvtGF0YDQsNC90LXQvdC40Lgg0LDQstCw0YLQsNGA0LA6JywgZXJyb3IpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcmVuZGVyTG9hZGluZyhmYWxzZSwgc2F2ZUJ1dHRvbik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLy/QodC70YPRiNCw0YLQtdC70Lgg0L3QsCDQt9Cw0LrRgNGL0YLQuNC1INGE0L7RgNC8ICsg0YHQu9GD0YjQsNGC0LXQu9GMINC/0L7RgdGC0LDQvdC+0LLQutC4INC70LDQudC60LBcclxucHJvZmlsZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgY2hhbmdlUHJvZmlsZSk7XHJcbm5ld1BsYWNlLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGFkZENhcmRUb0NhcmRzQXJyYXkpO1xyXG5hdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGNoYW5nZVByb2ZpbGVBdmF0YXIpO1xyXG5cclxucG9wdXBzLmZvckVhY2goZnVuY3Rpb24gKHBvcHVwKSB7XHJcbiAgcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgICBpZiAoXHJcbiAgICAgIGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0IHx8XHJcbiAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UnKVxyXG4gICAgKSB7XHJcbiAgICAgIGNsb3NlUG9wdXAocG9wdXApO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59KTtcclxuXHJcbi8v0JLRi9C30L7QstGLINGE0YPQvdC60YbQuNC5INC+0YLQutGA0YvRgtC40Y8g0Lgg0LfQsNC60YDRi9GC0LjRjyDQvNC+0LTQsNC70YzQvdGL0YUg0L7QutC+0L1cclxub3BlblBvcHVwQnlCdXR0b24oYWRkQnV0dG9uLCBwb3B1cEFkZE5ld0NhcmQpO1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcclxuXHJcbmZldGNoVXNlckRhdGFBbmRDYXJkcygpXHJcbiAgLnRoZW4oKHsgdXNlckRhdGEsIGNhcmRzRGF0YSB9KSA9PiB7XHJcbiAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXJEYXRhLm5hbWU7XHJcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcclxuICAgIHByb2ZpbGVJbWFnZS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSB1c2VyRGF0YS5hdmF0YXI7XHJcblxyXG4gICAgYWRkQ2FyZHMoY2FyZHNEYXRhKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ9Ce0YjQuNCx0LrQsCDQv9GA0Lgg0L/QvtC70YPRh9C10L3QuNC4INC00LDQvdC90YvRhSDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y86JywgZXJyb3IpO1xyXG4gIH0pO1xyXG4iXSwibmFtZXMiOlsiZXNjQ2FsbGJhY2siLCJwb3B1cHMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJvcGVuUG9wdXAiLCJwb3B1cCIsImNsYXNzTGlzdCIsImFkZCIsImV2dCIsImtleSIsImNsb3NlUG9wdXAiLCJjbG9zZVBvcGFwRXNjIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjdXJyZW50VXNlcklkIiwicG9wdXBJbWFnZSIsInF1ZXJ5U2VsZWN0b3IiLCJwb3B1cEltYWdlSW1hZ2UiLCJwb3B1cEltYWdlQ2FwdGlvbiIsImJhc2VVcmwiLCJjb25maWciLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsImNoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0IiwiY29uY2F0Iiwic3RhdHVzIiwicmVxdWVzdCIsInVybCIsIm9wdGlvbnMiLCJmZXRjaCIsInRoZW4iLCJsaWtlQ2FyZE9uU2VydmVyIiwiY2FyZElkIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJkaXNMaWtlQ2FyZE9uU2VydmVyIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImJ1dHRvbiIsImNvbnRhaW5zIiwiYnV0dG9uVGV4dCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiZXJyb3JTZWxlY3RvciIsImlucHV0SWQiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZXJyb3JFbGVtZW50IiwiaWQiLCJzZXRFdmVudExpc3RlbmVycyIsImlucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsImJ1dHRvbkVsZW1lbnQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJ2YWxpZGl0eSIsInBhdHRlcm5NaXNtYXRjaCIsInNldEN1c3RvbVZhbGlkaXR5IiwiZGF0YXNldCIsImVycm9yTWVzc2FnZSIsInZhbGlkIiwic2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImNoZWNrSW5wdXRWYWxpZGl0eSIsImNsZWFyVmFsaWRhdGlvbiIsInNldEF0dHJpYnV0ZSIsInNvbWUiLCJoYXNJbnZhbGlkSW5wdXQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJjYXJkc09uUGFnZSIsInBvcHVwQWRkTmV3Q2FyZCIsImNhcmRUZW1wbGF0ZSIsImNvbnRlbnQiLCJuZXdQbGFjZSIsImZvcm1zIiwicGxhY2VOYW1lIiwicGxhY2VMaW5rIiwiY3JlYXRlQ2FyZCIsInBsYWNlIiwiZGVsZXRlRnVuY3Rpb24iLCJsaWtlRnVuY3Rpb24iLCJjYXJkSXRlbSIsImNsb25lTm9kZSIsImRlbGV0ZUJ1dHRvbiIsImNhcmRJbWFnZSIsImNhcmRUaXRsZSIsImNhcmRMaWtlQnV0dG9uIiwibnVtYmVyT2ZMaWtlcyIsIl9pZCIsIm93bmVyIiwic3R5bGUiLCJkaXNwbGF5IiwibGlrZXMiLCJ1c2VyIiwic3JjIiwibGluayIsImFsdCIsIm5hbWUiLCJsZW5ndGgiLCJkZWxldGVDYXJkIiwiY2FyZFRvUmVtb3ZlIiwidGFyZ2V0IiwiY2xvc2VzdCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImxpa2VDYXJkIiwiY3VycmVudENhcmQiLCJjYXJkVG9MaWtlIiwiaXNMaWtlZCIsInVwZGF0ZWRDYXJkIiwidG9nZ2xlIiwicG9wdXBQcm9maWxlIiwiZWRpdEJ1dHRvbiIsImFkZEJ1dHRvbiIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZUZvcm0iLCJlZGl0UHJvZmlsZSIsInByb2ZpbGVGb3JtTmFtZSIsInByb2ZpbGVGb3JtRGVzY3JpcHRpb24iLCJzZXRQcm9maWxlRm9ybVZhbHVlcyIsInZhbHVlIiwiaW5wdXRFdmVudCIsIkV2ZW50IiwiYnViYmxlcyIsImRpc3BhdGNoRXZlbnQiLCJwcm9maWxlSW1hZ2UiLCJjaGFuZ2VBdmF0YXJCdXR0b24iLCJwb3B1cENoYW5nZUF2YXRhciIsImF2YXRhckZvcm0iLCJjaGFuZ2VBdmF0YXIiLCJjaGFuZ2VBdmF0YXJGb3JtIiwicHJldmVudERlZmF1bHQiLCJkZXNjcmlwdGlvbiIsInNhdmVCdXR0b24iLCJhYm91dCIsInJlc2V0IiwiZmluYWxseSIsImNhcmROYW1lIiwiY2FyZExpbmsiLCJzdWJtaXR0ZXIiLCJhZGRlZENhcmQiLCJuZXdQbGFjZUNhcmQiLCJpbnNlcnRCZWZvcmUiLCJmaXJzdENoaWxkIiwiZXJyb3IiLCJhdmF0YXJVcmwiLCJhdmF0YXIiLCJ1cGRhdGVVc2VyQXZhdGFyIiwiYmFja2dyb3VuZEltYWdlIiwiY3VycmVudFRhcmdldCIsImV2ZW50IiwiZW5hYmxlVmFsaWRhdGlvbiIsImFsbCIsInJlc3VsdCIsIl9yZWYiLCJfcmVmMiIsInVzZXJEYXRhIiwiY2FyZHNEYXRhIiwiY2FyZCIsImFwcGVuZENoaWxkIiwiYWRkQ2FyZHMiXSwic291cmNlUm9vdCI6IiJ9