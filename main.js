(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{Z1:()=>N,Oq:()=>h,kH:()=>I});var t,n=function(e,t){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.remove("form__input_type_error"),n.classList.remove("form__input-error_active"),n.textContent=""};function o(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove("button_inactive"),t.removeAttribute("disabled")):(t.classList.add("button_inactive"),t.setAttribute("disabled",!0))}function r(e){e.classList.add("popup_is-opened"),t=function(t){!function(e,t){"Escape"===e.key&&c(t)}(t,e)},document.addEventListener("keydown",t)}function c(e){var r,c;e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",t),r=e,(c=Array.from(r.querySelectorAll(".popup__input"))).forEach((function(e){n(r,e);var t=r.querySelector(".popup__button");o(c,t)}))}document.querySelectorAll(".popup").forEach((function(e){e.addEventListener("click",(function(t){(t.target===t.currentTarget||t.target.classList.contains("popup__close"))&&c(e)}))}));var a="6e340979d9839190a86d236f";function i(e){return fetch("https://nomoreparties.co/v1/wff-cohort-2/cards/likes/".concat(e),{method:"PUT",headers:{authorization:"c1324e8c-3ffd-41bf-8d8d-d39bc9277f92","Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}function u(e){return fetch("https://nomoreparties.co/v1/wff-cohort-2/cards/likes/".concat(e),{method:"DELETE",headers:{authorization:"c1324e8c-3ffd-41bf-8d8d-d39bc9277f92","Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}var s=document.querySelector(".places__list"),d=document.querySelector("#card-template").content,l=document.forms.newPlace,p=l.querySelector(".popup__input_type_card-name"),f=l.querySelector(".popup__input_type_url");function _(e,t,n,o){var r=d.querySelector(".card").cloneNode(!0),c=r.querySelector(".card__delete-button"),a=r.querySelector(".card__image"),i=r.querySelector(".card__title"),u=r.querySelector(".card__like-button"),s=r.querySelector(".likes-number");return e.owner&&e.owner._id===o?c.style.display="block":c.style.display="none",e.likes&&e.likes.some((function(e){return e._id===o}))&&u.classList.add("card__like-button_is-active"),a.src=e.link,a.alt="Фотография с места - "+e.name,i.textContent=e.name,s.textContent=e.likes.length,r.dataset.cardId=e._id||"",c.addEventListener("click",t),u.addEventListener("click",n),a.addEventListener("click",(function(){N(e.link,e.name)})),r}function m(e){var t,n=e.target.closest(".card");t=n.dataset.cardId,fetch("https://nomoreparties.co/v1/wff-cohort-2/cards/".concat(t),{method:"DELETE",headers:{authorization:"c1324e8c-3ffd-41bf-8d8d-d39bc9277f92","Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})),n.remove()}function y(e){var t=e.target.closest(".card"),n=t.querySelector(".card__like-button"),o=t.dataset.cardId,r=n.classList.contains("card__like-button_is-active");(r?u:i)(o).then((function(e){n.classList.toggle("card__like-button_is-active"),t.querySelector(".likes-number").textContent=e.likes.length,t.dataset.isLiked=r?"false":"true"}))}fetch("https://nomoreparties.co/v1/wff-cohort-2/cards",{headers:{authorization:"c1324e8c-3ffd-41bf-8d8d-d39bc9277f92"}}).then((function(e){return e.json()})).then((function(e){return Array.from(e)})).then((function(e){e.forEach((function(e){var t=_(e,m,y,a);s.appendChild(t)}))}));var v=document.querySelector(".popup_type_edit"),h=document.querySelector(".popup_type_new-card"),b=document.querySelector(".popup_type_image"),S=document.querySelector(".profile__edit-button"),k=document.querySelector(".profile__add-button"),q=b.querySelector(".popup__image"),g=b.querySelector(".popup__caption"),E=document.querySelector(".profile__title"),L=document.querySelector(".profile__description"),C=document.forms.editProfile,j=C.querySelector(".popup__input_type_name"),w=C.querySelector(".popup__input_type_description");function P(){j.value=E.textContent,w.value=L.textContent;var e=new Event("input",{bubbles:!0});j.dispatchEvent(e),w.dispatchEvent(e)}S.addEventListener("click",(function(){P(),r(v)})),P();var x,A=document.querySelector(".profile__image"),T=document.querySelector(".profile__image"),O=document.querySelector(".popup_type_new-avatar"),z=document.forms.changeAvatar,D=z.querySelector(".popup__input_type_avatar_url");function N(e,t){q.src=e,q.alt=t,g.textContent=t,r(b)}function I(e){var t=document.querySelector(".popup.popup_is-opened");if(t){var n=t.querySelector(".popup__button");n?n.textContent=e?"Сохранение...":"Сохранить":console.error("Ошибка: кнопка внутри активного попапа не найдена.")}else console.error("Ошибка: активный попап не найден.")}T.addEventListener("click",(function(){r(O)})),C.addEventListener("submit",(function(e){var t,n;e.preventDefault(),E.textContent=j.value,L.textContent=w.value,t=j.value,n=w.value,fetch("https://nomoreparties.co/v1/wff-cohort-2/users/me",{method:"PATCH",headers:{authorization:"c1324e8c-3ffd-41bf-8d8d-d39bc9277f92","Content-Type":"application/json"},body:JSON.stringify({name:t,about:n})}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).catch((function(e){throw console.log("Ошибка: ".concat(e)),e})),c(v),C.reset()})),newPlace.addEventListener("submit",(function(e){e.preventDefault();var t,n,o=_({name:p.value,link:f.value,likes:""},m,y,a);s.insertBefore(o,s.firstChild),o.querySelector(".card__delete-button").style.display="block",I(!0),(t=p.value,n=f.value,fetch("https://nomoreparties.co/v1/wff-cohort-2/cards ",{method:"POST",headers:{authorization:"c1324e8c-3ffd-41bf-8d8d-d39bc9277f92","Content-Type":"application/json"},body:JSON.stringify({name:t,link:n})}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).catch((function(e){throw console.log("Ошибка: ".concat(e)),e})).finally((function(){I(!1)}))).finally((function(){l.reset(),c(h)}))})),z.addEventListener("submit",(function(e){e.preventDefault();var t=D.value;A.style.backgroundImage="url('".concat(t,"')"),I(!0),function(e){return fetch("https://nomoreparties.co/v1/wff-cohort-2/users/me/avatar ",{method:"PATCH",headers:{authorization:"c1324e8c-3ffd-41bf-8d8d-d39bc9277f92","Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).catch((function(e){return console.log("Ошибка: ".concat(res.status))})).finally((function(e){return I(!1)}))}(t).then((function(){c(O),z.reset()}))})),x=h,k.addEventListener("click",(function(){r(x)})),Array.from(document.querySelectorAll(".popup__form")).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(".popup__input")),r=e.querySelector(".popup__button");o(t,r),t.forEach((function(c){c.addEventListener("input",(function(){!function(e,t){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?n(e,t):function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.add("form__input_type_error"),o.textContent=n,o.classList.add("form__input-error_active")}(e,t,t.validationMessage)}(e,c),o(t,r)}))}))}(e)})),fetch("https://nomoreparties.co/v1/wff-cohort-2/users/me",{headers:{authorization:"c1324e8c-3ffd-41bf-8d8d-d39bc9277f92"}}).then((function(e){return e.json()})).then((function(e){return{name:e.name,about:e.about,avatar:"url('".concat(e.avatar,"')")}})).then((function(e){E.textContent=e.name,L.textContent=e.about,A.style.backgroundImage=e.avatar})).catch((function(e){console.error("Ошибка получения данных пользователя:",e)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBQ0EsSUFBSUEsRUFBc0IsQ0NBMUJBLEVBQXdCLENBQUNDLEVBQVNDLEtBQ2pDLElBQUksSUFBSUMsS0FBT0QsRUFDWEYsRUFBb0JJLEVBQUVGLEVBQVlDLEtBQVNILEVBQW9CSSxFQUFFSCxFQUFTRSxJQUM1RUUsT0FBT0MsZUFBZUwsRUFBU0UsRUFBSyxDQUFFSSxZQUFZLEVBQU1DLElBQUtOLEVBQVdDLElBRTFFLEVDTkRILEVBQXdCLENBQUNTLEVBQUtDLElBQVVMLE9BQU9NLFVBQVVDLGVBQWVDLEtBQUtKLEVBQUtDLEkscUNDQWxGLElDRUlJLEVES0VDLEVBQWlCLFNBQUNDLEVBQWFDLEdBQ25DLElBQU1DLEVBQWVGLEVBQVlHLGNBQWMsSUFBREMsT0FBS0gsRUFBYUksR0FBRSxXQUNsRUosRUFBYUssVUFBVUMsT0FBTywwQkFDOUJMLEVBQWFJLFVBQVVDLE9BQU8sNEJBQzlCTCxFQUFhTSxZQUFjLEVBQzdCLEVBcURBLFNBQVNDLEVBQWtCQyxFQUFXQyxJQU50QyxTQUF5QkQsR0FDdkIsT0FBT0EsRUFBVUUsTUFBSyxTQUFVWCxHQUM5QixPQUFRQSxFQUFhWSxTQUFTQyxLQUNoQyxHQUNGLENBR01DLENBQWdCTCxJQUlsQkMsRUFBY0wsVUFBVUMsT0FBTyxtQkFDL0JJLEVBQWNLLGdCQUFnQixjQUo5QkwsRUFBY0wsVUFBVVcsSUFBSSxtQkFDNUJOLEVBQWNPLGFBQWEsWUFBWSxHQUszQyxDQ3JFTyxTQUFTQyxFQUFVQyxHQUN4QkEsRUFBTWQsVUFBVVcsSUFBSSxtQkFDcEJuQixFQUFjLFNBQVV1QixJQVkxQixTQUF1QkEsRUFBS0QsR0FDVixXQUFaQyxFQUFJbEMsS0FDTm1DLEVBQVdGLEVBRWYsQ0FmSUcsQ0FBY0YsRUFBS0QsRUFDckIsRUFDQUksU0FBU0MsaUJBQWlCLFVBQVczQixFQUN2QyxDQUVPLFNBQVN3QixFQUFXRixHRHFDcEIsSUFBeUJwQixFQUN4QlUsRUNyQ05VLEVBQU1kLFVBQVVDLE9BQU8sbUJBQ3ZCaUIsU0FBU0Usb0JBQW9CLFVBQVc1QixHRG1DVkUsRUNsQ2RvQixHRG1DVlYsRUFBWWlCLE1BQU1DLEtBQUs1QixFQUFZNkIsaUJBQWlCLG1CQUVoREMsU0FBUSxTQUFVN0IsR0FDMUJGLEVBQWVDLEVBQWFDLEdBQzVCLElBQU1VLEVBQWdCWCxFQUFZRyxjQUFjLGtCQUNoRE0sRUFBa0JDLEVBQVdDLEVBQy9CLEdDeENGLENBZmVhLFNBQVNLLGlCQUFpQixVQTZCbENDLFNBQVEsU0FBVVYsR0FDdkJBLEVBQU1LLGlCQUFpQixTQUFTLFNBQVVKLElBRXRDQSxFQUFJVSxTQUFXVixFQUFJVyxlQUNuQlgsRUFBSVUsT0FBT3pCLFVBQVUyQixTQUFTLGtCQUU5QlgsRUFBV0YsRUFFZixHQUNGLElDcENPLElBQU1jLEVBQWdCLDJCQWlHdEIsU0FBU0MsRUFBaUJDLEdBQy9CLE9BQU9DLE1BQU0sd0RBQURqQyxPQUM4Q2dDLEdBQ3hELENBQ0VFLE9BQVEsTUFDUkMsUUFBUyxDQUNQQyxjQUFlLHVDQUNmLGVBQWdCLG9CQUVsQkMsS0FBTUMsS0FBS0MsVUFBVSxDQUFDLEtBRXhCQyxNQUFLLFNBQUNDLEdBQ04sT0FBSUEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FFTkMsUUFBUUMsT0FBTyxXQUFEN0MsT0FBWXlDLEVBQUlLLFFBQ3ZDLEdBQ0YsQ0FFTyxTQUFTQyxFQUFvQmYsR0FDbEMsT0FBT0MsTUFBTSx3REFBRGpDLE9BQzhDZ0MsR0FDeEQsQ0FDRUUsT0FBUSxTQUNSQyxRQUFTLENBQ1BDLGNBQWUsdUNBQ2YsZUFBZ0Isb0JBRWxCQyxLQUFNQyxLQUFLQyxVQUFVLENBQUMsS0FFeEJDLE1BQUssU0FBQ0MsR0FDTixPQUFJQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVOQyxRQUFRQyxPQUFPLFdBQUQ3QyxPQUFZeUMsRUFBSUssUUFDdkMsR0FDRixDQzdITyxJQUFNRSxFQUFjNUIsU0FBU3JCLGNBQWMsaUJBQzVDa0QsRUFBZTdCLFNBQVNyQixjQUFjLGtCQUFrQm1ELFFBQ3hEQyxFQUFXL0IsU0FBU2dDLE1BQU1ELFNBQzFCRSxFQUFZRixFQUFTcEQsY0FBYyxnQ0FDbkN1RCxFQUFZSCxFQUFTcEQsY0FBYywwQkFHekMsU0FBU3dELEVBQVdDLEVBQU9DLEVBQWdCQyxFQUFjNUIsR0FDdkQsSUFBTTZCLEVBQVdWLEVBQWFsRCxjQUFjLFNBQVM2RCxXQUFVLEdBQ3pEQyxFQUFlRixFQUFTNUQsY0FBYyx3QkFDdEMrRCxFQUFZSCxFQUFTNUQsY0FBYyxnQkFDbkNnRSxFQUFZSixFQUFTNUQsY0FBYyxnQkFDbkNpRSxFQUFpQkwsRUFBUzVELGNBQWMsc0JBQ3hDa0UsRUFBZ0JOLEVBQVM1RCxjQUFjLGlCQW9CN0MsT0FuQkl5RCxFQUFNVSxPQUFTVixFQUFNVSxNQUFNQyxNQUFRckMsRUFDckMrQixFQUFhTyxNQUFNQyxRQUFVLFFBRTdCUixFQUFhTyxNQUFNQyxRQUFVLE9BRTNCYixFQUFNYyxPQUFTZCxFQUFNYyxNQUFNOUQsTUFBSyxTQUFDK0QsR0FBSSxPQUFLQSxFQUFLSixNQUFRckMsQ0FBYSxLQUN0RWtDLEVBQWU5RCxVQUFVVyxJQUFJLCtCQUUvQmlELEVBQVVVLElBQU1oQixFQUFNaUIsS0FDdEJYLEVBQVVZLElBQU0sd0JBQTBCbEIsRUFBTW1CLEtBQ2hEWixFQUFVM0QsWUFBY29ELEVBQU1tQixLQUM5QlYsRUFBYzdELFlBQWNvRCxFQUFNYyxNQUFNTSxPQUN4Q2pCLEVBQVNrQixRQUFRN0MsT0FBU3dCLEVBQU1XLEtBQU8sR0FDdkNOLEVBQWF4QyxpQkFBaUIsUUFBU29DLEdBQ3ZDTyxFQUFlM0MsaUJBQWlCLFFBQVNxQyxHQUN6Q0ksRUFBVXpDLGlCQUFpQixTQUFTLFdBQ2xDeUQsRUFBZXRCLEVBQU1pQixLQUFNakIsRUFBTW1CLEtBQ25DLElBRU9oQixDQUNULENBR0EsU0FBU29CLEVBQVc5RCxHQUNsQixJRG9DaUNlLEVDcEMzQmdELEVBQWUvRCxFQUFJVSxPQUFPc0QsUUFBUSxTRG9DUGpELEVDbkNsQmdELEVBQWFILFFBQVE3QyxPRG9DN0JDLE1BQU0sa0RBQURqQyxPQUFtRGdDLEdBQVUsQ0FDdkVFLE9BQVEsU0FDUkMsUUFBUyxDQUNQQyxjQUFlLHVDQUNmLGVBQWdCLHNCQUVqQkksTUFBSyxTQUFDQyxHQUNQLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5DLFFBQVFDLE9BQU8sV0FBRDdDLE9BQVl5QyxFQUFJSyxRQUN2QyxJQzdDQWtDLEVBQWE3RSxRQUNmLENBR08sU0FBUytFLEVBQVNqRSxHQUN2QixJQUFNa0UsRUFBY2xFLEVBQUlVLE9BQU9zRCxRQUFRLFNBQ2pDRyxFQUFhRCxFQUFZcEYsY0FBYyxzQkFDdkNpQyxFQUFTbUQsRUFBWU4sUUFBUTdDLE9BQzdCcUQsRUFBVUQsRUFBV2xGLFVBQVUyQixTQUFTLGdDQUMzQndELEVBQVV0QyxFQUFzQmhCLEdBQ3hDQyxHQUFRUSxNQUFLLFNBQUM4QyxHQUN2QkYsRUFBV2xGLFVBQVVxRixPQUFPLCtCQUNESixFQUFZcEYsY0FBYyxpQkFDbENLLFlBQWNrRixFQUFZaEIsTUFBTU0sT0FDbkRPLEVBQVlOLFFBQVFRLFFBQVVBLEVBQVUsUUFBVSxNQUNwRCxHQUNGLENEOUNTcEQsTUFBTSxpREFBa0QsQ0FDN0RFLFFBQVMsQ0FDUEMsY0FBZSwwQ0FHaEJJLE1BQUssU0FBQ0MsR0FBRyxPQUFLQSxFQUFJRSxNQUFNLElBQ3hCSCxNQUFLLFNBQUNnRCxHQUVMLE9BRCtCakUsTUFBTUMsS0FBS2dFLEVBRTVDLElDeUNtQmhELE1BQUssU0FBQ2lELEdBQ3pCQSxFQUF1Qi9ELFNBQVEsU0FBVThCLEdBQ3ZDLElBQU1rQyxFQUFPbkMsRUFBV0MsRUFBT3VCLEVBQVlHLEVBQVVwRCxHQUNyRGtCLEVBQVkyQyxZQUFZRCxFQUMxQixHQUNGLElDakVGLElBQU1FLEVBQWV4RSxTQUFTckIsY0FBYyxvQkFDL0I4RixFQUFrQnpFLFNBQVNyQixjQUFjLHdCQUN6QytGLEVBQWExRSxTQUFTckIsY0FBYyxxQkFFM0NnRyxFQUFhM0UsU0FBU3JCLGNBQWMseUJBQ3BDaUcsRUFBWTVFLFNBQVNyQixjQUFjLHdCQUVuQ2tHLEVBQWtCSCxFQUFXL0YsY0FBYyxpQkFDM0NtRyxFQUFvQkosRUFBVy9GLGNBQWMsbUJBRzdDb0csRUFBYy9FLFNBQVNyQixjQUFjLG1CQUNyQ3FHLEVBQXFCaEYsU0FBU3JCLGNBQWMseUJBQzVDc0csRUFBY2pGLFNBQVNnQyxNQUFNa0QsWUFDN0JDLEVBQWtCRixFQUFZdEcsY0FBYywyQkFDNUN5RyxFQUF5QkgsRUFBWXRHLGNBQ3pDLGtDQUdGLFNBQVMwRyxJQUNQRixFQUFnQkcsTUFBUVAsRUFBWS9GLFlBQ3BDb0csRUFBdUJFLE1BQVFOLEVBQW1CaEcsWUFDbEQsSUFBTXVHLEVBQWEsSUFBSUMsTUFBTSxRQUFTLENBQUVDLFNBQVMsSUFDakROLEVBQWdCTyxjQUFjSCxHQUM5QkgsRUFBdUJNLGNBQWNILEVBQ3ZDLENBT0FaLEVBQVcxRSxpQkFBaUIsU0FMNUIsV0FDRW9GLElBQ0ExRixFQUFVNkUsRUFDWixJQWdCQWEsSUFHQSxJSHJDMEN6RixFR3FDcEMrRixFQUFlM0YsU0FBU3JCLGNBQWMsbUJBQ3RDaUgsRUFBcUI1RixTQUFTckIsY0FBYyxtQkFDNUNrSCxFQUFvQjdGLFNBQVNyQixjQUFjLDBCQUMzQ21ILEVBQWE5RixTQUFTZ0MsTUFBTStELGFBQzVCQyxFQUFtQkYsRUFBV25ILGNBQ2xDLGlDQTJCSyxTQUFTK0UsRUFBZUwsRUFBTUMsR0FDbkN1QixFQUFnQnpCLElBQU1DLEVBQ3RCd0IsRUFBZ0J2QixJQUFNQSxFQUN0QndCLEVBQWtCOUYsWUFBY3NFLEVBQ2hDM0QsRUFBVStFLEVBQ1osQ0F1Qk8sU0FBU3VCLEVBQWNDLEdBQzVCLElBQU1DLEVBQWNuRyxTQUFTckIsY0FBYywwQkFDM0MsR0FBS3dILEVBQUwsQ0FJQSxJQUFNQyxFQUFjRCxFQUFZeEgsY0FBYyxrQkFDekN5SCxFQUtIQSxFQUFZcEgsWUFEVmtILEVBQ3dCLGdCQUVBLFlBTjFCRyxRQUFRQyxNQUFNLHFEQUhoQixNQUZFRCxRQUFRQyxNQUFNLG9DQWFsQixDQXBFQVYsRUFBbUIzRixpQkFBaUIsU0FBUyxXQUMzQ04sRUFBVWtHLEVBQ1osSUFjQVosRUFBWWhGLGlCQUFpQixVQXZDN0IsU0FBdUJKLEdGWmhCLElBQXFDMEQsRUFBTWdELEVFYWhEMUcsRUFBSTJHLGlCQUNKekIsRUFBWS9GLFlBQWNtRyxFQUFnQkcsTUFDMUNOLEVBQW1CaEcsWUFBY29HLEVBQXVCRSxNRmZkL0IsRUVpQnhDNEIsRUFBZ0JHLE1GakI4QmlCLEVFa0I5Q25CLEVBQXVCRSxNRmpCbEJ6RSxNQUFNLG9EQUFxRCxDQUNoRUMsT0FBUSxRQUNSQyxRQUFTLENBQ1BDLGNBQWUsdUNBQ2YsZUFBZ0Isb0JBRWxCQyxLQUFNQyxLQUFLQyxVQUFVLENBQ25Cb0MsS0FBTUEsRUFDTmtELE1BQU9GLE1BR1JuRixNQUFLLFNBQUNDLEdBQ0wsT0FBSUEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FFTkMsUUFBUUMsT0FBT0osRUFBSUssT0FDNUIsSUFDQ2dGLE9BQU0sU0FBQ0MsR0FFTixNQURBTixRQUFRTyxJQUFJLFdBQURoSSxPQUFZK0gsSUFDakJBLENBQ1IsSUVERjdHLEVBQVcwRSxHQUNYUyxFQUFZNEIsT0FDZCxJQThCQTlFLFNBQVM5QixpQkFBaUIsVURMbkIsU0FBNkJKLEdBQ2xDQSxFQUFJMkcsaUJBQ0osSUR6QmlDTSxFQUFVQyxFQzhCckNDLEVBQWU3RSxFQUxMLENBQ2RvQixLQUFNdEIsRUFBVXFELE1BQ2hCakMsS0FBTW5CLEVBQVVvRCxNQUNoQnBDLE1BQU8sSUFFZ0NTLEVBQVlHLEVBQVVwRCxHQUMvRGtCLEVBQVlxRixhQUFhRCxFQUFjcEYsRUFBWXNGLFlBQzlCRixFQUFhckksY0FBYyx3QkFDbkNxRSxNQUFNQyxRQUFVLFFBQzdCZ0QsR0FBYyxJRGxDbUJhLEVDbUNkN0UsRUFBVXFELE1EbkNjeUIsRUNtQ1A3RSxFQUFVb0QsTURsQ3ZDekUsTUFBTSxrREFBbUQsQ0FDOURDLE9BQVEsT0FDUkMsUUFBUyxDQUNQQyxjQUFlLHVDQUNmLGVBQWdCLG9CQUVsQkMsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQm9DLEtBQU11RCxFQUNOekQsS0FBTTBELE1BR1AzRixNQUFLLFNBQUNDLEdBQ0wsT0FBSUEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FFTkMsUUFBUUMsT0FBT0osRUFBSUssT0FDNUIsSUFDQ2dGLE9BQU0sU0FBQ0MsR0FFTixNQURBTixRQUFRTyxJQUFJLFdBQURoSSxPQUFZK0gsSUFDakJBLENBQ1IsSUFDQ1EsU0FBUSxXQUNQbEIsR0FBYyxFQUNoQixLQ1dtRGtCLFNBQVEsV0FDM0RwRixFQUFTOEUsUUFDVC9HLEVBQVcyRSxFQUNiLEdBQ0YsSUNWQXFCLEVBQVc3RixpQkFBaUIsVUFkNUIsU0FBNkJKLEdBQzNCQSxFQUFJMkcsaUJBQ0osSUFBTVksRUFBWXBCLEVBQWlCVixNQUNuQ0ssRUFBYTNDLE1BQU1xRSxnQkFBa0IsUUFBSHpJLE9BQVd3SSxFQUFTLE1BQ3REbkIsR0FBYyxHRjZEVCxTQUF3Qm1CLEdBQzdCLE9BQU92RyxNQUFNLDREQUE2RCxDQUN4RUMsT0FBUSxRQUNSQyxRQUFTLENBQ1BDLGNBQWUsdUNBQ2YsZUFBZ0Isb0JBRWxCQyxLQUFNQyxLQUFLQyxVQUFVLENBQ25CbUcsT0FBUUYsTUFHVGhHLE1BQUssU0FBQ0MsR0FDTCxPQUFJQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVOQyxRQUFRQyxPQUFPSixFQUFJSyxPQUM1QixJQUNDZ0YsT0FBTSxTQUFDQyxHQUFHLE9BQUtOLFFBQVFPLElBQUksV0FBRGhJLE9BQVl5QyxJQUFJSyxRQUFTLElBQ25EeUYsU0FBUSxTQUFDOUYsR0FBRyxPQUFLNEUsR0FBYyxFQUFNLEdBQzFDLENFL0VFc0IsQ0FBZUgsR0FBV2hHLE1BQUssV0FDN0J0QixFQUFXK0YsR0FDWEMsRUFBV2UsT0FDYixHQUNGLElIMUQwQ2pILEVHa0ViNkUsRUFBWEcsRUhqRVQzRSxpQkFBaUIsU0FBUyxXQUMvQk4sRUFBVUMsRUFDWixJRGFpQk8sTUFBTUMsS0FBS0osU0FBU0ssaUJBQWlCLGlCQUM3Q0MsU0FBUSxTQUFVOUIsR0FDekJBLEVBQVl5QixpQkFBaUIsVUFBVSxTQUFVdUgsR0FDL0NBLEVBQU1oQixnQkFDUixJQWpCSixTQUEyQmhJLEdBQ3pCLElBQU1VLEVBQVlpQixNQUFNQyxLQUFLNUIsRUFBWTZCLGlCQUFpQixrQkFDcERsQixFQUFnQlgsRUFBWUcsY0FBYyxrQkFDaERNLEVBQWtCQyxFQUFXQyxHQUM3QkQsRUFBVW9CLFNBQVEsU0FBVTdCLEdBQzFCQSxFQUFhd0IsaUJBQWlCLFNBQVMsWUFsQjNDLFNBQTRCekIsRUFBYUMsR0FDbkNBLEVBQWFZLFNBQVNvSSxnQkFDeEJoSixFQUFhaUosa0JBQWtCakosRUFBYWdGLFFBQVFrRSxjQUVwRGxKLEVBQWFpSixrQkFBa0IsSUFHNUJqSixFQUFhWSxTQUFTQyxNQUd6QmYsRUFBZUMsRUFBYUMsR0F4QlQsU0FBQ0QsRUFBYUMsRUFBY2tKLEdBQ2pELElBQU1qSixFQUFlRixFQUFZRyxjQUFjLElBQURDLE9BQUtILEVBQWFJLEdBQUUsV0FDbEVKLEVBQWFLLFVBQVVXLElBQUksMEJBQzNCZixFQUFhTSxZQUFjMkksRUFDM0JqSixFQUFhSSxVQUFVVyxJQUFJLDJCQUM3QixDQWlCSW1JLENBQWVwSixFQUFhQyxFQUFjQSxFQUFhb0osa0JBSTNELENBT01DLENBQW1CdEosRUFBYUMsR0FDaENRLEVBQWtCQyxFQUFXQyxFQUMvQixHQUNGLEdBQ0YsQ0FRSTRJLENBQWtCdkosRUFDcEIsSUV4Q09xQyxNQUFNLG9EQUFxRCxDQUNoRUUsUUFBUyxDQUNQQyxjQUFlLDBDQUdoQkksTUFBSyxTQUFDQyxHQUFHLE9BQUtBLEVBQUlFLE1BQU0sSUFDeEJILE1BQUssU0FBQ2dELEdBQ0wsTUFBTyxDQUNMYixLQUFNYSxFQUFPYixLQUNia0QsTUFBT3JDLEVBQU9xQyxNQUNkYSxPQUFRLFFBQUYxSSxPQUFVd0YsRUFBT2tELE9BQU0sTUFFakMsSUU4RkRsRyxNQUFLLFNBQUM0RyxHQUNMakQsRUFBWS9GLFlBQWNnSixFQUFTekUsS0FDbkN5QixFQUFtQmhHLFlBQWNnSixFQUFTdkIsTUFDMUNkLEVBQWEzQyxNQUFNcUUsZ0JBQWtCVyxFQUFTVixNQUNoRCxJQUNDWixPQUFNLFNBQUNKLEdBQ05ELFFBQVFDLE1BQU0sd0NBQXlDQSxFQUN6RCxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8veWFuZGV4X3ByYWt0aWt1bS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly95YW5kZXhfcHJha3Rpa3VtL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly95YW5kZXhfcHJha3Rpa3VtL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8veWFuZGV4X3ByYWt0aWt1bS8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8veWFuZGV4X3ByYWt0aWt1bS8uL3NyYy9zY3JpcHRzL21vZGFsLmpzIiwid2VicGFjazovL3lhbmRleF9wcmFrdGlrdW0vLi9zcmMvc2NyaXB0cy9hcGkuanMiLCJ3ZWJwYWNrOi8veWFuZGV4X3ByYWt0aWt1bS8uL3NyYy9zY3JpcHRzL2NhcmQuanMiLCJ3ZWJwYWNrOi8veWFuZGV4X3ByYWt0aWt1bS8uL3NyYy9zY3JpcHRzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdmb3JtX19pbnB1dF90eXBlX2Vycm9yJyk7XHJcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdmb3JtX19pbnB1dC1lcnJvcl9hY3RpdmUnKTtcclxufTtcclxuXHJcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQpID0+IHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2Zvcm1fX2lucHV0X3R5cGVfZXJyb3InKTtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnZm9ybV9faW5wdXQtZXJyb3JfYWN0aXZlJyk7XHJcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCkge1xyXG4gIGlmIChpbnB1dEVsZW1lbnQudmFsaWRpdHkucGF0dGVybk1pc21hdGNoKSB7XHJcbiAgICBpbnB1dEVsZW1lbnQuc2V0Q3VzdG9tVmFsaWRpdHkoaW5wdXRFbGVtZW50LmRhdGFzZXQuZXJyb3JNZXNzYWdlKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaW5wdXRFbGVtZW50LnNldEN1c3RvbVZhbGlkaXR5KCcnKTtcclxuICB9XHJcblxyXG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50KTtcclxuICB9XHJcbn1cclxuZnVuY3Rpb24gc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQpIHtcclxuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9faW5wdXQnKSk7XHJcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uJyk7XHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KTtcclxuICBpbnB1dExpc3QuZm9yRWFjaChmdW5jdGlvbiAoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50KTtcclxuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19mb3JtJykpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goZnVuY3Rpb24gKGZvcm1FbGVtZW50KSB7XHJcbiAgICBmb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJWYWxpZGF0aW9uKGZvcm1FbGVtZW50KSB7XHJcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0JykpO1xyXG5cclxuICBpbnB1dExpc3QuZm9yRWFjaChmdW5jdGlvbiAoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50KTtcclxuICAgIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbicpO1xyXG4gICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZShmdW5jdGlvbiAoaW5wdXRFbGVtZW50KSB7XHJcbiAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KSB7XHJcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2J1dHRvbl9pbmFjdGl2ZScpO1xyXG4gICAgYnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgdHJ1ZSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnYnV0dG9uX2luYWN0aXZlJyk7XHJcbiAgICBidXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgY2xlYXJWYWxpZGF0aW9uIH0gZnJvbSBcIi4vdmFsaWRhdGlvbi5qc1wiO1xyXG5jb25zdCBwb3B1cHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwXCIpO1xyXG5sZXQgZXNjQ2FsbGJhY2s7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gb3BlblBvcHVwKHBvcHVwKSB7XHJcbiAgcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX2lzLW9wZW5lZFwiKTtcclxuICBlc2NDYWxsYmFjayA9IGZ1bmN0aW9uIChldnQpIHtcclxuICAgIGNsb3NlUG9wYXBFc2MoZXZ0LCBwb3B1cCk7XHJcbiAgfTtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBlc2NDYWxsYmFjayk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjbG9zZVBvcHVwKHBvcHVwKSB7XHJcbiAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX2lzLW9wZW5lZFwiKTtcclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBlc2NDYWxsYmFjayk7XHJcbiAgY2xlYXJWYWxpZGF0aW9uKHBvcHVwKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VQb3BhcEVzYyhldnQsIHBvcHVwKSB7XHJcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgIGNsb3NlUG9wdXAocG9wdXApO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5Qb3B1cEJ5QnV0dG9uKGJ1dHRvbiwgcG9wdXApIHtcclxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgIG9wZW5Qb3B1cChwb3B1cCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbnBvcHVwcy5mb3JFYWNoKGZ1bmN0aW9uIChwb3B1cCkge1xyXG4gIHBvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgICBpZiAoXHJcbiAgICAgIGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0IHx8XHJcbiAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX2Nsb3NlXCIpXHJcbiAgICApIHtcclxuICAgICAgY2xvc2VQb3B1cChwb3B1cCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn0pO1xyXG4iLCIvLyDQsiDRhNCw0LnQu9C1IGFwaS5qcyDQvtC/0LjRgdCw0L3RiyDRhNGD0L3QutGG0LjQuCDQtNC70Y8g0LLQt9Cw0LjQvNC+0LTQtdC50YHRgtCy0LjRjyDRgSDRgdC10YDQstC10YDQvtC8O1xyXG5pbXBvcnQgeyByZW5kZXJMb2FkaW5nIH0gZnJvbSAnLi9pbmRleC5qcyc7XHJcblxyXG5leHBvcnQgY29uc3QgY3VycmVudFVzZXJJZCA9ICc2ZTM0MDk3OWQ5ODM5MTkwYTg2ZDIzNmYnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHV6ZXJBdXRob3JpemF0aW9uKCkge1xyXG4gIHJldHVybiBmZXRjaCgnaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3dmZi1jb2hvcnQtMi91c2Vycy9tZScsIHtcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgYXV0aG9yaXphdGlvbjogJ2MxMzI0ZThjLTNmZmQtNDFiZi04ZDhkLWQzOWJjOTI3N2Y5MicsXHJcbiAgICB9LFxyXG4gIH0pXHJcbiAgICAudGhlbigocmVzKSA9PiByZXMuanNvbigpKVxyXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxyXG4gICAgICAgIGFib3V0OiByZXN1bHQuYWJvdXQsXHJcbiAgICAgICAgYXZhdGFyOiBgdXJsKCcke3Jlc3VsdC5hdmF0YXJ9JylgLFxyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDYXJkc0Zyb21TZXJ2ZXIoKSB7XHJcbiAgcmV0dXJuIGZldGNoKCdodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2ZmLWNvaG9ydC0yL2NhcmRzJywge1xyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICBhdXRob3JpemF0aW9uOiAnYzEzMjRlOGMtM2ZmZC00MWJmLThkOGQtZDM5YmM5Mjc3ZjkyJyxcclxuICAgIH0sXHJcbiAgfSlcclxuICAgIC50aGVuKChyZXMpID0+IHJlcy5qc29uKCkpXHJcbiAgICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICAgIGNvbnN0IGluaXRpYWxDYXJkc0Zyb21TZXJ2ZXIgPSBBcnJheS5mcm9tKHJlc3VsdCk7XHJcbiAgICAgIHJldHVybiBpbml0aWFsQ2FyZHNGcm9tU2VydmVyO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwdXNoTXlBdXRob3JpemF0aW9uVG9TZXJ2ZXIobmFtZSwgZGVzY3JpcHRpb24pIHtcclxuICByZXR1cm4gZmV0Y2goJ2h0dHBzOi8vbm9tb3JlcGFydGllcy5jby92MS93ZmYtY29ob3J0LTIvdXNlcnMvbWUnLCB7XHJcbiAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgIGF1dGhvcml6YXRpb246ICdjMTMyNGU4Yy0zZmZkLTQxYmYtOGQ4ZC1kMzliYzkyNzdmOTInLFxyXG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgfSxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgYWJvdXQ6IGRlc2NyaXB0aW9uLFxyXG4gICAgfSksXHJcbiAgfSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwOiAke2Vycn1gKTtcclxuICAgICAgdGhyb3cgZXJyO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwdXNoTXlDYXJkVG9TZXJ2ZXIoY2FyZE5hbWUsIGNhcmRMaW5rKSB7XHJcbiAgcmV0dXJuIGZldGNoKCdodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2ZmLWNvaG9ydC0yL2NhcmRzICcsIHtcclxuICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICBhdXRob3JpemF0aW9uOiAnYzEzMjRlOGMtM2ZmZC00MWJmLThkOGQtZDM5YmM5Mjc3ZjkyJyxcclxuICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgIH0sXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgIG5hbWU6IGNhcmROYW1lLFxyXG4gICAgICBsaW5rOiBjYXJkTGluayxcclxuICAgIH0pLFxyXG4gIH0pXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1cyk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coYNCe0YjQuNCx0LrQsDogJHtlcnJ9YCk7XHJcbiAgICAgIHRocm93IGVycjtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBkZWxldGVDYXJkT25TZXJ2ZXIoY2FyZElkKSB7XHJcbiAgcmV0dXJuIGZldGNoKGBodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2ZmLWNvaG9ydC0yL2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgIGF1dGhvcml6YXRpb246ICdjMTMyNGU4Yy0zZmZkLTQxYmYtOGQ4ZC1kMzliYzkyNzdmOTInLFxyXG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgfSxcclxuICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbGlrZUNhcmRPblNlcnZlcihjYXJkSWQpIHtcclxuICByZXR1cm4gZmV0Y2goXHJcbiAgICBgaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3dmZi1jb2hvcnQtMi9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLFxyXG4gICAge1xyXG4gICAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogJ2MxMzI0ZThjLTNmZmQtNDFiZi04ZDhkLWQzOWJjOTI3N2Y5MicsXHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe30pLFxyXG4gICAgfVxyXG4gICkudGhlbigocmVzKSA9PiB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRpc0xpa2VDYXJkT25TZXJ2ZXIoY2FyZElkKSB7XHJcbiAgcmV0dXJuIGZldGNoKFxyXG4gICAgYGh0dHBzOi8vbm9tb3JlcGFydGllcy5jby92MS93ZmYtY29ob3J0LTIvY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCxcclxuICAgIHtcclxuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246ICdjMTMyNGU4Yy0zZmZkLTQxYmYtOGQ4ZC1kMzliYzkyNzdmOTInLFxyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHt9KSxcclxuICAgIH1cclxuICApLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjaGFuZ2VNeUF2YXRhcihhdmF0YXJVcmwpIHtcclxuICByZXR1cm4gZmV0Y2goJ2h0dHBzOi8vbm9tb3JlcGFydGllcy5jby92MS93ZmYtY29ob3J0LTIvdXNlcnMvbWUvYXZhdGFyICcsIHtcclxuICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgYXV0aG9yaXphdGlvbjogJ2MxMzI0ZThjLTNmZmQtNDFiZi04ZDhkLWQzOWJjOTI3N2Y5MicsXHJcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICB9LFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICBhdmF0YXI6IGF2YXRhclVybCxcclxuICAgIH0pLFxyXG4gIH0pXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1cyk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKSlcclxuICAgIC5maW5hbGx5KChyZXMpID0+IHJlbmRlckxvYWRpbmcoZmFsc2UpKTtcclxufVxyXG4iLCJpbXBvcnQgeyBvcGVuSW1hZ2VQb3B1cCwgcG9wdXBBZGROZXdDYXJkLCByZW5kZXJMb2FkaW5nIH0gZnJvbSAnLi9pbmRleC5qcyc7XHJcbmltcG9ydCB7IGNsb3NlUG9wdXAgfSBmcm9tICcuL21vZGFsLmpzJztcclxuaW1wb3J0IHtcclxuICBnZXRDYXJkc0Zyb21TZXJ2ZXIsXHJcbiAgcHVzaE15Q2FyZFRvU2VydmVyLFxyXG4gIGN1cnJlbnRVc2VySWQsXHJcbiAgZGVsZXRlQ2FyZE9uU2VydmVyLFxyXG4gIGxpa2VDYXJkT25TZXJ2ZXIsXHJcbiAgZGlzTGlrZUNhcmRPblNlcnZlcixcclxufSBmcm9tICcuL2FwaS5qcyc7XHJcblxyXG5leHBvcnQgY29uc3QgY2FyZHNPblBhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VzX19saXN0Jyk7XHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjYXJkLXRlbXBsYXRlJykuY29udGVudDtcclxuY29uc3QgbmV3UGxhY2UgPSBkb2N1bWVudC5mb3Jtcy5uZXdQbGFjZTtcclxuY29uc3QgcGxhY2VOYW1lID0gbmV3UGxhY2UucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX2NhcmQtbmFtZScpO1xyXG5jb25zdCBwbGFjZUxpbmsgPSBuZXdQbGFjZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfdXJsJyk7XHJcblxyXG4vLyDQpNGD0L3QutGG0LjRjyDRgdC+0LfQtNCw0L3QuNGPINC60LDRgNGC0L7Rh9C60LhcclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChwbGFjZSwgZGVsZXRlRnVuY3Rpb24sIGxpa2VGdW5jdGlvbiwgY3VycmVudFVzZXJJZCkge1xyXG4gIGNvbnN0IGNhcmRJdGVtID0gY2FyZFRlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkJykuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IGNhcmRJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnV0dG9uJyk7XHJcbiAgY29uc3QgY2FyZEltYWdlID0gY2FyZEl0ZW0ucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJyk7XHJcbiAgY29uc3QgY2FyZFRpdGxlID0gY2FyZEl0ZW0ucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJyk7XHJcbiAgY29uc3QgY2FyZExpa2VCdXR0b24gPSBjYXJkSXRlbS5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKTtcclxuICBjb25zdCBudW1iZXJPZkxpa2VzID0gY2FyZEl0ZW0ucXVlcnlTZWxlY3RvcignLmxpa2VzLW51bWJlcicpO1xyXG4gIGlmIChwbGFjZS5vd25lciAmJiBwbGFjZS5vd25lci5faWQgPT09IGN1cnJlbnRVc2VySWQpIHtcclxuICAgIGRlbGV0ZUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICB9IGVsc2Uge1xyXG4gICAgZGVsZXRlQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgfVxyXG4gIGlmIChwbGFjZS5saWtlcyAmJiBwbGFjZS5saWtlcy5zb21lKCh1c2VyKSA9PiB1c2VyLl9pZCA9PT0gY3VycmVudFVzZXJJZCkpIHtcclxuICAgIGNhcmRMaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZScpO1xyXG4gIH1cclxuICBjYXJkSW1hZ2Uuc3JjID0gcGxhY2UubGluaztcclxuICBjYXJkSW1hZ2UuYWx0ID0gJ9Ck0L7RgtC+0LPRgNCw0YTQuNGPINGBINC80LXRgdGC0LAgLSAnICsgcGxhY2UubmFtZTtcclxuICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSBwbGFjZS5uYW1lO1xyXG4gIG51bWJlck9mTGlrZXMudGV4dENvbnRlbnQgPSBwbGFjZS5saWtlcy5sZW5ndGg7XHJcbiAgY2FyZEl0ZW0uZGF0YXNldC5jYXJkSWQgPSBwbGFjZS5faWQgfHwgJyc7XHJcbiAgZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZGVsZXRlRnVuY3Rpb24pO1xyXG4gIGNhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbGlrZUZ1bmN0aW9uKTtcclxuICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBvcGVuSW1hZ2VQb3B1cChwbGFjZS5saW5rLCBwbGFjZS5uYW1lKTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGNhcmRJdGVtO1xyXG59XHJcblxyXG4vL9Ck0YPQvdC60YbQuNGPINGD0LTQsNC70LXQvdC40Y8g0LrQsNGA0YLQvtGH0LrQuFxyXG5mdW5jdGlvbiBkZWxldGVDYXJkKGV2dCkge1xyXG4gIGNvbnN0IGNhcmRUb1JlbW92ZSA9IGV2dC50YXJnZXQuY2xvc2VzdCgnLmNhcmQnKTtcclxuICBjb25zdCBjYXJkSWQgPSBjYXJkVG9SZW1vdmUuZGF0YXNldC5jYXJkSWQ7XHJcbiAgZGVsZXRlQ2FyZE9uU2VydmVyKGNhcmRJZCk7XHJcbiAgY2FyZFRvUmVtb3ZlLnJlbW92ZSgpO1xyXG59XHJcblxyXG4vLyDQpNGD0L3QutGG0LjRjyDQu9Cw0LnQutCwINC60LDRgNGC0L7Rh9C60LhcclxuZXhwb3J0IGZ1bmN0aW9uIGxpa2VDYXJkKGV2dCkge1xyXG4gIGNvbnN0IGN1cnJlbnRDYXJkID0gZXZ0LnRhcmdldC5jbG9zZXN0KCcuY2FyZCcpO1xyXG4gIGNvbnN0IGNhcmRUb0xpa2UgPSBjdXJyZW50Q2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKTtcclxuICBjb25zdCBjYXJkSWQgPSBjdXJyZW50Q2FyZC5kYXRhc2V0LmNhcmRJZDtcclxuICBjb25zdCBpc0xpa2VkID0gY2FyZFRvTGlrZS5jbGFzc0xpc3QuY29udGFpbnMoJ2NhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZScpO1xyXG4gIGNvbnN0IGxpa2VBY3Rpb24gPSBpc0xpa2VkID8gZGlzTGlrZUNhcmRPblNlcnZlciA6IGxpa2VDYXJkT25TZXJ2ZXI7XHJcbiAgbGlrZUFjdGlvbihjYXJkSWQpLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XHJcbiAgICBjYXJkVG9MaWtlLmNsYXNzTGlzdC50b2dnbGUoJ2NhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZScpO1xyXG4gICAgY29uc3QgbGlrZXNOdW1iZXJFbGVtZW50ID0gY3VycmVudENhcmQucXVlcnlTZWxlY3RvcignLmxpa2VzLW51bWJlcicpO1xyXG4gICAgbGlrZXNOdW1iZXJFbGVtZW50LnRleHRDb250ZW50ID0gdXBkYXRlZENhcmQubGlrZXMubGVuZ3RoO1xyXG4gICAgY3VycmVudENhcmQuZGF0YXNldC5pc0xpa2VkID0gaXNMaWtlZCA/ICdmYWxzZScgOiAndHJ1ZSc7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vINCS0YvQstC10YHRgtC4INC60LDRgNGC0L7Rh9C60Lgg0L3QsCDRgdGC0YDQsNC90LjRhtGDXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRDYXJkcygpIHtcclxuICBnZXRDYXJkc0Zyb21TZXJ2ZXIoKS50aGVuKChpbml0aWFsQ2FyZHNGcm9tU2VydmVyKSA9PiB7XHJcbiAgICBpbml0aWFsQ2FyZHNGcm9tU2VydmVyLmZvckVhY2goZnVuY3Rpb24gKHBsYWNlKSB7XHJcbiAgICAgIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKHBsYWNlLCBkZWxldGVDYXJkLCBsaWtlQ2FyZCwgY3VycmVudFVzZXJJZCk7XHJcbiAgICAgIGNhcmRzT25QYWdlLmFwcGVuZENoaWxkKGNhcmQpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8v0JTQvtCx0LDQstC70LXQvdC40LUg0L3QvtCy0L7QuSDQutCw0YDRgtC+0YfQutC4INGH0LXRgNC10Lcg0L/QvtC/0LDQv1xyXG5leHBvcnQgZnVuY3Rpb24gYWRkQ2FyZFRvQ2FyZHNBcnJheShldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBuZXdDYXJkID0ge1xyXG4gICAgbmFtZTogcGxhY2VOYW1lLnZhbHVlLFxyXG4gICAgbGluazogcGxhY2VMaW5rLnZhbHVlLFxyXG4gICAgbGlrZXM6ICcnLFxyXG4gIH07XHJcbiAgY29uc3QgbmV3UGxhY2VDYXJkID0gY3JlYXRlQ2FyZChuZXdDYXJkLCBkZWxldGVDYXJkLCBsaWtlQ2FyZCwgY3VycmVudFVzZXJJZCk7XHJcbiAgY2FyZHNPblBhZ2UuaW5zZXJ0QmVmb3JlKG5ld1BsYWNlQ2FyZCwgY2FyZHNPblBhZ2UuZmlyc3RDaGlsZCk7XHJcbiAgY29uc3QgZGVsZXRlQnV0dG9uID0gbmV3UGxhY2VDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnV0dG9uJyk7XHJcbiAgZGVsZXRlQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gIHJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgcHVzaE15Q2FyZFRvU2VydmVyKHBsYWNlTmFtZS52YWx1ZSwgcGxhY2VMaW5rLnZhbHVlKS5maW5hbGx5KCgpID0+IHtcclxuICAgIG5ld1BsYWNlLnJlc2V0KCk7XHJcbiAgICBjbG9zZVBvcHVwKHBvcHVwQWRkTmV3Q2FyZCk7XHJcbiAgfSk7XHJcbn1cclxuIiwiaW1wb3J0ICcuLi9wYWdlcy9pbmRleC5jc3MnO1xyXG5pbXBvcnQgeyBhZGRDYXJkcywgYWRkQ2FyZFRvQ2FyZHNBcnJheSB9IGZyb20gJy4vY2FyZC5qcyc7XHJcbmltcG9ydCB7IG9wZW5Qb3B1cCwgY2xvc2VQb3B1cCwgb3BlblBvcHVwQnlCdXR0b24gfSBmcm9tICcuL21vZGFsLmpzJztcclxuaW1wb3J0IHsgZW5hYmxlVmFsaWRhdGlvbiB9IGZyb20gJy4vdmFsaWRhdGlvbi5qcyc7XHJcbmltcG9ydCB7XHJcbiAgdXplckF1dGhvcml6YXRpb24sXHJcbiAgcHVzaE15QXV0aG9yaXphdGlvblRvU2VydmVyLFxyXG4gIGNoYW5nZU15QXZhdGFyLFxyXG59IGZyb20gJy4vYXBpLmpzJztcclxuXHJcbmFkZENhcmRzKCk7XHJcblxyXG5jb25zdCBwb3B1cFByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9lZGl0Jyk7XHJcbmV4cG9ydCBjb25zdCBwb3B1cEFkZE5ld0NhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9uZXctY2FyZCcpO1xyXG5leHBvcnQgY29uc3QgcG9wdXBJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2ltYWdlJyk7XHJcblxyXG5jb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnV0dG9uJyk7XHJcbmNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XHJcblxyXG5jb25zdCBwb3B1cEltYWdlSW1hZ2UgPSBwb3B1cEltYWdlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcclxuY29uc3QgcG9wdXBJbWFnZUNhcHRpb24gPSBwb3B1cEltYWdlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2FwdGlvbicpO1xyXG5cclxuLy8g0JHQu9C+0Log0L7RgtCy0LXRh9Cw0Y7RidC40Lkg0LfQsCDRgdC+0YXRgNCw0L3QtdC90LjQtSDQtNCw0L3QvdGL0YUg0LIgcG9wdXAgJ9GA0LXQtNCw0LrRgtC40YDQvtCy0LDQvdC40LUg0L/RgNC+0YTQuNC70Y8nXHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3RpdGxlJyk7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19kZXNjcmlwdGlvbicpO1xyXG5jb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zLmVkaXRQcm9maWxlO1xyXG5jb25zdCBwcm9maWxlRm9ybU5hbWUgPSBwcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfbmFtZScpO1xyXG5jb25zdCBwcm9maWxlRm9ybURlc2NyaXB0aW9uID0gcHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcihcclxuICAnLnBvcHVwX19pbnB1dF90eXBlX2Rlc2NyaXB0aW9uJ1xyXG4pO1xyXG5cclxuZnVuY3Rpb24gc2V0UHJvZmlsZUZvcm1WYWx1ZXMoKSB7XHJcbiAgcHJvZmlsZUZvcm1OYW1lLnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgcHJvZmlsZUZvcm1EZXNjcmlwdGlvbi52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcclxuICBjb25zdCBpbnB1dEV2ZW50ID0gbmV3IEV2ZW50KCdpbnB1dCcsIHsgYnViYmxlczogdHJ1ZSB9KTtcclxuICBwcm9maWxlRm9ybU5hbWUuZGlzcGF0Y2hFdmVudChpbnB1dEV2ZW50KTtcclxuICBwcm9maWxlRm9ybURlc2NyaXB0aW9uLmRpc3BhdGNoRXZlbnQoaW5wdXRFdmVudCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5Qcm9maWxlUG9wdXBCeUJ1dHRvbigpIHtcclxuICBzZXRQcm9maWxlRm9ybVZhbHVlcygpO1xyXG4gIG9wZW5Qb3B1cChwb3B1cFByb2ZpbGUpO1xyXG59XHJcblxyXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3BlblByb2ZpbGVQb3B1cEJ5QnV0dG9uKTtcclxuXHJcbmZ1bmN0aW9uIGNoYW5nZVByb2ZpbGUoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBwcm9maWxlRm9ybU5hbWUudmFsdWU7XHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gcHJvZmlsZUZvcm1EZXNjcmlwdGlvbi52YWx1ZTtcclxuICBwdXNoTXlBdXRob3JpemF0aW9uVG9TZXJ2ZXIoXHJcbiAgICBwcm9maWxlRm9ybU5hbWUudmFsdWUsXHJcbiAgICBwcm9maWxlRm9ybURlc2NyaXB0aW9uLnZhbHVlXHJcbiAgKTtcclxuICBjbG9zZVBvcHVwKHBvcHVwUHJvZmlsZSk7XHJcbiAgcHJvZmlsZUZvcm0ucmVzZXQoKTtcclxufVxyXG5cclxuc2V0UHJvZmlsZUZvcm1WYWx1ZXMoKTtcclxuXHJcbi8v0JjQt9C80LXQvdC10L3QuNC1INCw0LLQsNGC0LDRgNCwINGH0LXRgNC10Lcg0L/QvtC/0LDQv1xyXG5jb25zdCBwcm9maWxlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faW1hZ2UnKTtcclxuY29uc3QgY2hhbmdlQXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlJyk7XHJcbmNvbnN0IHBvcHVwQ2hhbmdlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfbmV3LWF2YXRhcicpO1xyXG5jb25zdCBhdmF0YXJGb3JtID0gZG9jdW1lbnQuZm9ybXMuY2hhbmdlQXZhdGFyO1xyXG5jb25zdCBjaGFuZ2VBdmF0YXJGb3JtID0gYXZhdGFyRm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICcucG9wdXBfX2lucHV0X3R5cGVfYXZhdGFyX3VybCdcclxuKTtcclxuXHJcbmNoYW5nZUF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICBvcGVuUG9wdXAocG9wdXBDaGFuZ2VBdmF0YXIpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGNoYW5nZVByb2ZpbGVBdmF0YXIoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3QgYXZhdGFyVXJsID0gY2hhbmdlQXZhdGFyRm9ybS52YWx1ZTtcclxuICBwcm9maWxlSW1hZ2Uuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgnJHthdmF0YXJVcmx9JylgO1xyXG4gIHJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgY2hhbmdlTXlBdmF0YXIoYXZhdGFyVXJsKS50aGVuKCgpID0+IHtcclxuICAgIGNsb3NlUG9wdXAocG9wdXBDaGFuZ2VBdmF0YXIpO1xyXG4gICAgYXZhdGFyRm9ybS5yZXNldCgpO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vL9Ch0LvRg9GI0LDRgtC10LvQuCDQvdCwINC30LDQutGA0YvRgtC40LUg0YTQvtGA0LwgKyDRgdC70YPRiNCw0YLQtdC70Ywg0L/QvtGB0YLQsNC90L7QstC60Lgg0LvQsNC50LrQsFxyXG5wcm9maWxlRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBjaGFuZ2VQcm9maWxlKTtcclxubmV3UGxhY2UuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgYWRkQ2FyZFRvQ2FyZHNBcnJheSk7XHJcbmF2YXRhckZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgY2hhbmdlUHJvZmlsZUF2YXRhcik7XHJcblxyXG4vL9CS0YvQt9C+0LLRiyDRhNGD0L3QutGG0LjQuSDQvtGC0LrRgNGL0YLQuNGPINC4INC30LDQutGA0YvRgtC40Y8g0LzQvtC00LDQu9GM0L3Ri9GFINC+0LrQvtC9XHJcbm9wZW5Qb3B1cEJ5QnV0dG9uKGFkZEJ1dHRvbiwgcG9wdXBBZGROZXdDYXJkKTtcclxuXHJcbi8v0L7RgtC60YDRi9GC0LjQtSDQv9C+0L/QsNC/0LAg0LjQt9C+0LHRgNCw0LbQtdC90LjRj1xyXG5leHBvcnQgZnVuY3Rpb24gb3BlbkltYWdlUG9wdXAobGluaywgYWx0KSB7XHJcbiAgcG9wdXBJbWFnZUltYWdlLnNyYyA9IGxpbms7XHJcbiAgcG9wdXBJbWFnZUltYWdlLmFsdCA9IGFsdDtcclxuICBwb3B1cEltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IGFsdDtcclxuICBvcGVuUG9wdXAocG9wdXBJbWFnZSk7XHJcbn1cclxuXHJcbi8v0LLRi9C30L7QsiDQstCw0LvQuNC00LDRhtC40LhcclxuZW5hYmxlVmFsaWRhdGlvbih7XHJcbiAgZm9ybVNlbGVjdG9yOiAnLnBvcHVwX19mb3JtJyxcclxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX2J1dHRvbicsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19idXR0b25fZGlzYWJsZWQnLFxyXG4gIGlucHV0RXJyb3JDbGFzczogJ3BvcHVwX19pbnB1dF90eXBlX2Vycm9yJyxcclxuICBlcnJvckNsYXNzOiAncG9wdXBfX2Vycm9yX3Zpc2libGUnLFxyXG59KTtcclxuXHJcbi8v0YDQsNCx0L7RgtCwINGBINGB0LXRgNCy0LXRgNC+0LxcclxudXplckF1dGhvcml6YXRpb24oKVxyXG4gIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdXNlckRhdGEuYWJvdXQ7XHJcbiAgICBwcm9maWxlSW1hZ2Uuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gdXNlckRhdGEuYXZhdGFyO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcign0J7RiNC40LHQutCwINC/0L7Qu9GD0YfQtdC90LjRjyDQtNCw0L3QvdGL0YUg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPOicsIGVycm9yKTtcclxuICB9KTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xyXG4gIGNvbnN0IGFjdGl2ZVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLnBvcHVwX2lzLW9wZW5lZCcpO1xyXG4gIGlmICghYWN0aXZlUG9wdXApIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ9Ce0YjQuNCx0LrQsDog0LDQutGC0LjQstC90YvQuSDQv9C+0L/QsNC/INC90LUg0L3QsNC50LTQtdC9LicpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBjb25zdCBwb3B1cEJ1dHRvbiA9IGFjdGl2ZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uJyk7XHJcbiAgaWYgKCFwb3B1cEJ1dHRvbikge1xyXG4gICAgY29uc29sZS5lcnJvcign0J7RiNC40LHQutCwOiDQutC90L7Qv9C60LAg0LLQvdGD0YLRgNC4INCw0LrRgtC40LLQvdC+0LPQviDQv9C+0L/QsNC/0LAg0L3QtSDQvdCw0LnQtNC10L3QsC4nKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgcG9wdXBCdXR0b24udGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBwb3B1cEJ1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QuNGC0YwnO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsImV4cG9ydHMiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJlc2NDYWxsYmFjayIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJlcnJvckVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29uY2F0IiwiaWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0ZXh0Q29udGVudCIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiYnV0dG9uRWxlbWVudCIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwicmVtb3ZlQXR0cmlidXRlIiwiYWRkIiwic2V0QXR0cmlidXRlIiwib3BlblBvcHVwIiwicG9wdXAiLCJldnQiLCJjbG9zZVBvcHVwIiwiY2xvc2VQb3BhcEVzYyIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJjb250YWlucyIsImN1cnJlbnRVc2VySWQiLCJsaWtlQ2FyZE9uU2VydmVyIiwiY2FyZElkIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJkaXNMaWtlQ2FyZE9uU2VydmVyIiwiY2FyZHNPblBhZ2UiLCJjYXJkVGVtcGxhdGUiLCJjb250ZW50IiwibmV3UGxhY2UiLCJmb3JtcyIsInBsYWNlTmFtZSIsInBsYWNlTGluayIsImNyZWF0ZUNhcmQiLCJwbGFjZSIsImRlbGV0ZUZ1bmN0aW9uIiwibGlrZUZ1bmN0aW9uIiwiY2FyZEl0ZW0iLCJjbG9uZU5vZGUiLCJkZWxldGVCdXR0b24iLCJjYXJkSW1hZ2UiLCJjYXJkVGl0bGUiLCJjYXJkTGlrZUJ1dHRvbiIsIm51bWJlck9mTGlrZXMiLCJvd25lciIsIl9pZCIsInN0eWxlIiwiZGlzcGxheSIsImxpa2VzIiwidXNlciIsInNyYyIsImxpbmsiLCJhbHQiLCJuYW1lIiwibGVuZ3RoIiwiZGF0YXNldCIsIm9wZW5JbWFnZVBvcHVwIiwiZGVsZXRlQ2FyZCIsImNhcmRUb1JlbW92ZSIsImNsb3Nlc3QiLCJsaWtlQ2FyZCIsImN1cnJlbnRDYXJkIiwiY2FyZFRvTGlrZSIsImlzTGlrZWQiLCJ1cGRhdGVkQ2FyZCIsInRvZ2dsZSIsInJlc3VsdCIsImluaXRpYWxDYXJkc0Zyb21TZXJ2ZXIiLCJjYXJkIiwiYXBwZW5kQ2hpbGQiLCJwb3B1cFByb2ZpbGUiLCJwb3B1cEFkZE5ld0NhcmQiLCJwb3B1cEltYWdlIiwiZWRpdEJ1dHRvbiIsImFkZEJ1dHRvbiIsInBvcHVwSW1hZ2VJbWFnZSIsInBvcHVwSW1hZ2VDYXB0aW9uIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlRm9ybSIsImVkaXRQcm9maWxlIiwicHJvZmlsZUZvcm1OYW1lIiwicHJvZmlsZUZvcm1EZXNjcmlwdGlvbiIsInNldFByb2ZpbGVGb3JtVmFsdWVzIiwidmFsdWUiLCJpbnB1dEV2ZW50IiwiRXZlbnQiLCJidWJibGVzIiwiZGlzcGF0Y2hFdmVudCIsInByb2ZpbGVJbWFnZSIsImNoYW5nZUF2YXRhckJ1dHRvbiIsInBvcHVwQ2hhbmdlQXZhdGFyIiwiYXZhdGFyRm9ybSIsImNoYW5nZUF2YXRhciIsImNoYW5nZUF2YXRhckZvcm0iLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwiYWN0aXZlUG9wdXAiLCJwb3B1cEJ1dHRvbiIsImNvbnNvbGUiLCJlcnJvciIsImRlc2NyaXB0aW9uIiwicHJldmVudERlZmF1bHQiLCJhYm91dCIsImNhdGNoIiwiZXJyIiwibG9nIiwicmVzZXQiLCJjYXJkTmFtZSIsImNhcmRMaW5rIiwibmV3UGxhY2VDYXJkIiwiaW5zZXJ0QmVmb3JlIiwiZmlyc3RDaGlsZCIsImZpbmFsbHkiLCJhdmF0YXJVcmwiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJhdmF0YXIiLCJjaGFuZ2VNeUF2YXRhciIsImV2ZW50IiwicGF0dGVybk1pc21hdGNoIiwic2V0Q3VzdG9tVmFsaWRpdHkiLCJlcnJvck1lc3NhZ2UiLCJzaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ1c2VyRGF0YSJdLCJzb3VyY2VSb290IjoiIn0=