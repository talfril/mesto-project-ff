(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{Z1:()=>I,Oq:()=>S,kH:()=>H});var t,n=function(e,t){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.remove("form__input_type_error"),n.classList.remove("form__input-error_active"),n.textContent=""};function r(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove("button_inactive"),t.removeAttribute("disabled")):(t.classList.add("button_inactive"),t.setAttribute("disabled",!0))}function o(e){e.classList.add("popup_is-opened"),t=function(t){!function(e,t){"Escape"===e.key&&c(t)}(t,e)},document.addEventListener("keydown",t)}function c(e){var o,c;e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",t),o=e,(c=Array.from(o.querySelectorAll(".popup__input"))).forEach((function(e){n(o,e);var t=o.querySelector(".popup__button");r(c,t)}))}document.querySelectorAll(".popup").forEach((function(e){e.addEventListener("click",(function(t){(t.target===t.currentTarget||t.target.classList.contains("popup__close"))&&c(e)}))}));var a="6e340979d9839190a86d236f",u={baseUrl:"https://nomoreparties.co/v1/wff-cohort-2",headers:{authorization:"c1324e8c-3ffd-41bf-8d8d-d39bc9277f92","Content-Type":"application/json"}};function i(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}function s(e){return fetch("".concat(u.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:u.headers,body:JSON.stringify({})}).then(i)}function l(e){return fetch("".concat(u.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:u.headers,body:JSON.stringify({})}).then(i)}var d=document.querySelector(".places__list"),p=document.querySelector("#card-template").content,f=document.forms.newPlace,_=f.querySelector(".popup__input_type_card-name"),y=f.querySelector(".popup__input_type_url");function v(e,t,n,r){var o=p.querySelector(".card").cloneNode(!0),c=o.querySelector(".card__delete-button"),a=o.querySelector(".card__image"),u=o.querySelector(".card__title"),i=o.querySelector(".card__like-button"),s=o.querySelector(".likes-number"),l=e._id||"";return o.dataset.cardId=l,e.owner&&e.owner._id===r?c.style.display="block":c.style.display="none",e.likes&&e.likes.some((function(e){return e._id===r}))&&i.classList.add("card__like-button_is-active"),a.src=e.link,a.alt="Фотография с места - "+e.name,u.textContent=e.name,s.textContent=e.likes.length,c.addEventListener("click",t),i.addEventListener("click",(function(){n(l)})),a.addEventListener("click",(function(){I(e.link,e.name)})),o}function m(e){var t,n=e.target.closest(".card");(t=n.dataset.cardId,fetch("".concat(u.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:u.headers})).then(i).catch((function(e){throw console.log("Ошибка: ".concat(e)),e})),n.remove()}function h(e){var t=document.querySelector(".card[data-card-id='".concat(e,"']")),n=t.querySelector(".card__like-button"),r=n.classList.contains("card__like-button_is-active");(r?l:s)(e).then((function(e){n.classList.toggle("card__like-button_is-active"),t.querySelector(".likes-number").textContent=e.likes.length,t.dataset.isLiked=r?"false":"true"})).catch((function(e){console.log("Ошибка при обработке лайка/дизлайка: ".concat(e))}))}fetch("".concat(u.baseUrl,"/cards"),{headers:u.headers}).then(i).then((function(e){return Array.from(e)})).then((function(e){e.forEach((function(e){var t=v(e,m,h,a);d.appendChild(t)}))}));var b=document.querySelector(".popup_type_edit"),S=document.querySelector(".popup_type_new-card"),q=document.querySelector(".popup_type_image"),k=document.querySelector(".profile__edit-button"),g=document.querySelector(".profile__add-button"),L=q.querySelector(".popup__image"),E=q.querySelector(".popup__caption"),C=document.querySelector(".profile__title"),x=document.querySelector(".profile__description"),A=document.forms.editProfile,w=A.querySelector(".popup__input_type_name"),O=A.querySelector(".popup__input_type_description");function P(){w.value=C.textContent,O.value=x.textContent;var e=new Event("input",{bubbles:!0});w.dispatchEvent(e),O.dispatchEvent(e)}k.addEventListener("click",(function(){P(),o(b)})),P();var U,T=document.querySelector(".profile__image"),D=document.querySelector(".profile__image"),N=document.querySelector(".popup_type_new-avatar"),j=document.forms.changeAvatar,J=j.querySelector(".popup__input_type_avatar_url");function I(e,t){L.src=e,L.alt=t,E.textContent=t,o(q)}function H(e,t){if(t&&t.classList.contains("popup__button")){var n=e?"Сохранение...":"Сохранить";t.textContent=n}}D.addEventListener("click",(function(){o(N)})),A.addEventListener("submit",(function(e){e.preventDefault();var t,n,r=e.target.querySelector(".popup__button");H(!0,r),C.textContent=w.value,x.textContent=O.value,(t=w.value,n=O.value,fetch("".concat(u.baseUrl,"/users/me"),{method:"PATCH",headers:u.headers,body:JSON.stringify({name:t,about:n})})).then(i).then((function(){c(b),A.reset()})).catch((function(e){console.log("Ошибка: ".concat(e))})).finally((function(){H(!1,r)}))})),newPlace.addEventListener("submit",(function(e){e.preventDefault(),_.value,y.value;var t,n,r=e.target.querySelector(".popup__button");H(!0,r),(t=_.value,n=y.value,fetch("".concat(u.baseUrl,"/cards"),{method:"POST",headers:u.headers,body:JSON.stringify({name:t,link:n})}).then(i)).then((function(e){var t=v(e,m,h,a);d.insertBefore(t,d.firstChild),t.querySelector(".card__delete-button").style.display="block",f.reset(),c(S)})).catch((function(e){console.error("Ошибка при добавлении карточки:",e)})).finally((function(){H(!1,r)}))})),j.addEventListener("submit",(function(e){e.preventDefault();var t=j.querySelector(".popup__button"),n=J.value;T.style.backgroundImage="url('".concat(n,"')"),H(!0,t),function(e){return fetch("".concat(u.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:u.headers,body:JSON.stringify({avatar:e})}).then(i)}(n).then((function(){c(N),j.reset()})).catch((function(e){console.error("Ошибка при сохранении аватара:",e)})).finally((function(){H(!1,t)}))})),U=S,g.addEventListener("click",(function(){o(U)})),Array.from(document.querySelectorAll(".popup__form")).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(".popup__input")),o=e.querySelector(".popup__button");r(t,o),t.forEach((function(c){c.addEventListener("input",(function(){!function(e,t){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?n(e,t):function(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add("form__input_type_error"),r.textContent=n,r.classList.add("form__input-error_active")}(e,t,t.validationMessage)}(e,c),r(t,o)}))}))}(e)})),fetch("".concat(u.baseUrl,"/users/me"),{headers:u.headers}).then(i).then((function(e){return{name:e.name,about:e.about,avatar:"url('".concat(e.avatar,"')")}})).then((function(e){C.textContent=e.name,x.textContent=e.about,T.style.backgroundImage=e.avatar})).catch((function(e){console.error("Ошибка получения данных пользователя:",e)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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eF9wcmFrdGlrdW0vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8veWFuZGV4X3ByYWt0aWt1bS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8veWFuZGV4X3ByYWt0aWt1bS93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3lhbmRleF9wcmFrdGlrdW0vLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3lhbmRleF9wcmFrdGlrdW0vLi9zcmMvc2NyaXB0cy9tb2RhbC5qcyIsIndlYnBhY2s6Ly95YW5kZXhfcHJha3Rpa3VtLy4vc3JjL3NjcmlwdHMvYXBpLmpzIiwid2VicGFjazovL3lhbmRleF9wcmFrdGlrdW0vLi9zcmMvc2NyaXB0cy9jYXJkLmpzIiwid2VicGFjazovL3lhbmRleF9wcmFrdGlrdW0vLi9zcmMvc2NyaXB0cy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkgPT4ge1xyXG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZm9ybV9faW5wdXRfdHlwZV9lcnJvcicpO1xyXG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZm9ybV9faW5wdXQtZXJyb3JfYWN0aXZlJyk7XHJcbn07XHJcblxyXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdmb3JtX19pbnB1dF90eXBlX2Vycm9yJyk7XHJcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2Zvcm1fX2lucHV0LWVycm9yX2FjdGl2ZScpO1xyXG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQpIHtcclxuICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnBhdHRlcm5NaXNtYXRjaCkge1xyXG4gICAgaW5wdXRFbGVtZW50LnNldEN1c3RvbVZhbGlkaXR5KGlucHV0RWxlbWVudC5kYXRhc2V0LmVycm9yTWVzc2FnZSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGlucHV0RWxlbWVudC5zZXRDdXN0b21WYWxpZGl0eSgnJyk7XHJcbiAgfVxyXG5cclxuICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCk7XHJcbiAgfVxyXG59XHJcbmZ1bmN0aW9uIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50KSB7XHJcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0JykpO1xyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbicpO1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goZnVuY3Rpb24gKGlucHV0RWxlbWVudCkge1xyXG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9fZm9ybScpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChmb3JtRWxlbWVudCkge1xyXG4gICAgZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50KTtcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVmFsaWRhdGlvbihmb3JtRWxlbWVudCkge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19pbnB1dCcpKTtcclxuXHJcbiAgaW5wdXRMaXN0LmZvckVhY2goZnVuY3Rpb24gKGlucHV0RWxlbWVudCkge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCk7XHJcbiAgICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcclxuICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcclxuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoZnVuY3Rpb24gKGlucHV0RWxlbWVudCkge1xyXG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCkge1xyXG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdidXR0b25faW5hY3RpdmUnKTtcclxuICAgIGJ1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsIHRydWUpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2J1dHRvbl9pbmFjdGl2ZScpO1xyXG4gICAgYnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IGNsZWFyVmFsaWRhdGlvbiB9IGZyb20gXCIuL3ZhbGlkYXRpb24uanNcIjtcclxuY29uc3QgcG9wdXBzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cFwiKTtcclxubGV0IGVzY0NhbGxiYWNrO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5Qb3B1cChwb3B1cCkge1xyXG4gIHBvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9pcy1vcGVuZWRcIik7XHJcbiAgZXNjQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgICBjbG9zZVBvcGFwRXNjKGV2dCwgcG9wdXApO1xyXG4gIH07XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZXNjQ2FsbGJhY2spO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VQb3B1cChwb3B1cCkge1xyXG4gIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9pcy1vcGVuZWRcIik7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZXNjQ2FsbGJhY2spO1xyXG4gIGNsZWFyVmFsaWRhdGlvbihwb3B1cCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlUG9wYXBFc2MoZXZ0LCBwb3B1cCkge1xyXG4gIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICBjbG9zZVBvcHVwKHBvcHVwKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBvcGVuUG9wdXBCeUJ1dHRvbihidXR0b24sIHBvcHVwKSB7XHJcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBvcGVuUG9wdXAocG9wdXApO1xyXG4gIH0pO1xyXG59XHJcblxyXG5wb3B1cHMuZm9yRWFjaChmdW5jdGlvbiAocG9wdXApIHtcclxuICBwb3B1cC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgaWYgKFxyXG4gICAgICBldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldCB8fFxyXG4gICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19jbG9zZVwiKVxyXG4gICAgKSB7XHJcbiAgICAgIGNsb3NlUG9wdXAocG9wdXApO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59KTtcclxuIiwiZXhwb3J0IGNvbnN0IGN1cnJlbnRVc2VySWQgPSAnNmUzNDA5NzlkOTgzOTE5MGE4NmQyMzZmJztcclxuY29uc3QgY29uZmlnID0ge1xyXG4gIGJhc2VVcmw6ICdodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2ZmLWNvaG9ydC0yJyxcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiAnYzEzMjRlOGMtM2ZmZC00MWJmLThkOGQtZDM5YmM5Mjc3ZjkyJyxcclxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgfSxcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gIGlmICghcmVzLm9rKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuICByZXR1cm4gcmVzLmpzb24oKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHV6ZXJBdXRob3JpemF0aW9uKCkge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWVgLCB7IGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzIH0pXHJcbiAgICAudGhlbihjaGVja1Jlc3BvbnNlKVxyXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxyXG4gICAgICAgIGFib3V0OiByZXN1bHQuYWJvdXQsXHJcbiAgICAgICAgYXZhdGFyOiBgdXJsKCcke3Jlc3VsdC5hdmF0YXJ9JylgLFxyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDYXJkc0Zyb21TZXJ2ZXIoKSB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gIH0pXHJcbiAgICAudGhlbihjaGVja1Jlc3BvbnNlKVxyXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICBjb25zdCBpbml0aWFsQ2FyZHNGcm9tU2VydmVyID0gQXJyYXkuZnJvbShyZXN1bHQpO1xyXG4gICAgICByZXR1cm4gaW5pdGlhbENhcmRzRnJvbVNlcnZlcjtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcHVzaE15QXV0aG9yaXphdGlvblRvU2VydmVyKG5hbWUsIGRlc2NyaXB0aW9uKSB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICBhYm91dDogZGVzY3JpcHRpb24sXHJcbiAgICB9KSxcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHB1c2hNeUNhcmRUb1NlcnZlcihjYXJkTmFtZSwgY2FyZExpbmspIHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgbmFtZTogY2FyZE5hbWUsXHJcbiAgICAgIGxpbms6IGNhcmRMaW5rLFxyXG4gICAgfSksXHJcbiAgfSkudGhlbihjaGVja1Jlc3BvbnNlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZUNhcmRPblNlcnZlcihjYXJkSWQpIHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGxpa2VDYXJkT25TZXJ2ZXIoY2FyZElkKSB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7fSksXHJcbiAgfSkudGhlbihjaGVja1Jlc3BvbnNlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRpc0xpa2VDYXJkT25TZXJ2ZXIoY2FyZElkKSB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7fSksXHJcbiAgfSkudGhlbihjaGVja1Jlc3BvbnNlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNoYW5nZU15QXZhdGFyKGF2YXRhclVybCkge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgIGF2YXRhcjogYXZhdGFyVXJsLFxyXG4gICAgfSksXHJcbiAgfSkudGhlbihjaGVja1Jlc3BvbnNlKTtcclxufVxyXG4iLCJpbXBvcnQgeyBvcGVuSW1hZ2VQb3B1cCwgcG9wdXBBZGROZXdDYXJkLCByZW5kZXJMb2FkaW5nIH0gZnJvbSAnLi9pbmRleC5qcyc7XHJcbmltcG9ydCB7IGNsb3NlUG9wdXAgfSBmcm9tICcuL21vZGFsLmpzJztcclxuaW1wb3J0IHtcclxuICBnZXRDYXJkc0Zyb21TZXJ2ZXIsXHJcbiAgcHVzaE15Q2FyZFRvU2VydmVyLFxyXG4gIGN1cnJlbnRVc2VySWQsXHJcbiAgZGVsZXRlQ2FyZE9uU2VydmVyLFxyXG4gIGxpa2VDYXJkT25TZXJ2ZXIsXHJcbiAgZGlzTGlrZUNhcmRPblNlcnZlcixcclxuICBjaGVja1Jlc3BvbnNlLFxyXG59IGZyb20gJy4vYXBpLmpzJztcclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkc09uUGFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZXNfX2xpc3QnKTtcclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NhcmQtdGVtcGxhdGUnKS5jb250ZW50O1xyXG5jb25zdCBuZXdQbGFjZSA9IGRvY3VtZW50LmZvcm1zLm5ld1BsYWNlO1xyXG5jb25zdCBwbGFjZU5hbWUgPSBuZXdQbGFjZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfY2FyZC1uYW1lJyk7XHJcbmNvbnN0IHBsYWNlTGluayA9IG5ld1BsYWNlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV91cmwnKTtcclxuXHJcbi8vINCk0YPQvdC60YbQuNGPINGB0L7Qt9C00LDQvdC40Y8g0LrQsNGA0YLQvtGH0LrQuFxyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKHBsYWNlLCBkZWxldGVGdW5jdGlvbiwgbGlrZUZ1bmN0aW9uLCBjdXJyZW50VXNlcklkKSB7XHJcbiAgY29uc3QgY2FyZEl0ZW0gPSBjYXJkVGVtcGxhdGUucXVlcnlTZWxlY3RvcignLmNhcmQnKS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgY29uc3QgZGVsZXRlQnV0dG9uID0gY2FyZEl0ZW0ucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKTtcclxuICBjb25zdCBjYXJkSW1hZ2UgPSBjYXJkSXRlbS5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKTtcclxuICBjb25zdCBjYXJkVGl0bGUgPSBjYXJkSXRlbS5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdGl0bGUnKTtcclxuICBjb25zdCBjYXJkTGlrZUJ1dHRvbiA9IGNhcmRJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ1dHRvbicpO1xyXG4gIGNvbnN0IG51bWJlck9mTGlrZXMgPSBjYXJkSXRlbS5xdWVyeVNlbGVjdG9yKCcubGlrZXMtbnVtYmVyJyk7XHJcblxyXG4gIGNvbnN0IGNhcmRJZCA9IHBsYWNlLl9pZCB8fCAnJzsgXHJcbiAgY2FyZEl0ZW0uZGF0YXNldC5jYXJkSWQgPSBjYXJkSWQ7XHJcblxyXG4gIGlmIChwbGFjZS5vd25lciAmJiBwbGFjZS5vd25lci5faWQgPT09IGN1cnJlbnRVc2VySWQpIHtcclxuICAgIGRlbGV0ZUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICB9IGVsc2Uge1xyXG4gICAgZGVsZXRlQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgfVxyXG4gIGlmIChwbGFjZS5saWtlcyAmJiBwbGFjZS5saWtlcy5zb21lKCh1c2VyKSA9PiB1c2VyLl9pZCA9PT0gY3VycmVudFVzZXJJZCkpIHtcclxuICAgIGNhcmRMaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZScpO1xyXG4gIH1cclxuICBjYXJkSW1hZ2Uuc3JjID0gcGxhY2UubGluaztcclxuICBjYXJkSW1hZ2UuYWx0ID0gJ9Ck0L7RgtC+0LPRgNCw0YTQuNGPINGBINC80LXRgdGC0LAgLSAnICsgcGxhY2UubmFtZTtcclxuICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSBwbGFjZS5uYW1lO1xyXG4gIG51bWJlck9mTGlrZXMudGV4dENvbnRlbnQgPSBwbGFjZS5saWtlcy5sZW5ndGg7XHJcbiAgZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZGVsZXRlRnVuY3Rpb24pO1xyXG4gIGNhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgbGlrZUZ1bmN0aW9uKGNhcmRJZCk7IFxyXG4gIH0pO1xyXG4gIGNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgIG9wZW5JbWFnZVBvcHVwKHBsYWNlLmxpbmssIHBsYWNlLm5hbWUpO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gY2FyZEl0ZW07XHJcbn1cclxuXHJcbi8v0KTRg9C90LrRhtC40Y8g0YPQtNCw0LvQtdC90LjRjyDQutCw0YDRgtC+0YfQutC4XHJcbmZ1bmN0aW9uIGRlbGV0ZUNhcmQoZXZ0KSB7XHJcbiAgY29uc3QgY2FyZFRvUmVtb3ZlID0gZXZ0LnRhcmdldC5jbG9zZXN0KCcuY2FyZCcpO1xyXG4gIGNvbnN0IGNhcmRJZCA9IGNhcmRUb1JlbW92ZS5kYXRhc2V0LmNhcmRJZDtcclxuICBkZWxldGVDYXJkT25TZXJ2ZXIoY2FyZElkKVxyXG4gICAgLnRoZW4oY2hlY2tSZXNwb25zZSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDQntGI0LjQsdC60LA6ICR7ZXJyfWApO1xyXG4gICAgICB0aHJvdyBlcnI7XHJcbiAgICB9KTtcclxuICBjYXJkVG9SZW1vdmUucmVtb3ZlKCk7XHJcbn1cclxuXHJcbi8vINCk0YPQvdC60YbQuNGPINC70LDQudC60LAv0LTQuNC30LvQsNC50LrQsCDQutCw0YDRgtC+0YfQutC4XHJcbmV4cG9ydCBmdW5jdGlvbiBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICBjb25zdCBjdXJyZW50Q2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5jYXJkW2RhdGEtY2FyZC1pZD0nJHtjYXJkSWR9J11gKTtcclxuICBjb25zdCBjYXJkVG9MaWtlID0gY3VycmVudENhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJyk7XHJcbiAgY29uc3QgaXNMaWtlZCA9IGNhcmRUb0xpa2UuY2xhc3NMaXN0LmNvbnRhaW5zKCdjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmUnKTtcclxuICBjb25zdCBsaWtlQWN0aW9uID0gaXNMaWtlZCA/IGRpc0xpa2VDYXJkT25TZXJ2ZXIgOiBsaWtlQ2FyZE9uU2VydmVyO1xyXG4gIGxpa2VBY3Rpb24oY2FyZElkKVxyXG4gICAgLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XHJcbiAgICAgIGNhcmRUb0xpa2UuY2xhc3NMaXN0LnRvZ2dsZSgnY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlJyk7XHJcbiAgICAgIGNvbnN0IGxpa2VzTnVtYmVyRWxlbWVudCA9IGN1cnJlbnRDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5saWtlcy1udW1iZXInKTtcclxuICAgICAgbGlrZXNOdW1iZXJFbGVtZW50LnRleHRDb250ZW50ID0gdXBkYXRlZENhcmQubGlrZXMubGVuZ3RoO1xyXG4gICAgICBjdXJyZW50Q2FyZC5kYXRhc2V0LmlzTGlrZWQgPSBpc0xpa2VkID8gJ2ZhbHNlJyA6ICd0cnVlJztcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwINC/0YDQuCDQvtCx0YDQsNCx0L7RgtC60LUg0LvQsNC50LrQsC/QtNC40LfQu9Cw0LnQutCwOiAke2Vycn1gKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyDQktGL0LLQtdGB0YLQuCDQutCw0YDRgtC+0YfQutC4INC90LAg0YHRgtGA0LDQvdC40YbRg1xyXG5leHBvcnQgZnVuY3Rpb24gYWRkQ2FyZHMoKSB7XHJcbiAgZ2V0Q2FyZHNGcm9tU2VydmVyKCkudGhlbigoaW5pdGlhbENhcmRzRnJvbVNlcnZlcikgPT4ge1xyXG4gICAgaW5pdGlhbENhcmRzRnJvbVNlcnZlci5mb3JFYWNoKGZ1bmN0aW9uIChwbGFjZSkge1xyXG4gICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChwbGFjZSwgZGVsZXRlQ2FyZCwgbGlrZUNhcmQsIGN1cnJlbnRVc2VySWQpO1xyXG4gICAgICBjYXJkc09uUGFnZS5hcHBlbmRDaGlsZChjYXJkKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vLyDQlNC+0LHQsNCy0LvQtdC90LjQtSDQvdC+0LLQvtC5INC60LDRgNGC0L7Rh9C60Lgg0YfQtdGA0LXQtyDQv9C+0L/QsNC/XHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRDYXJkVG9DYXJkc0FycmF5KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IG5ld0NhcmQgPSB7XHJcbiAgICBuYW1lOiBwbGFjZU5hbWUudmFsdWUsXHJcbiAgICBsaW5rOiBwbGFjZUxpbmsudmFsdWUsXHJcbiAgICBsaWtlczogJycsXHJcbiAgfTtcclxuXHJcbiAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGV2dC50YXJnZXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcclxuICByZW5kZXJMb2FkaW5nKHRydWUsIHNhdmVCdXR0b24pO1xyXG5cclxuICBwdXNoTXlDYXJkVG9TZXJ2ZXIocGxhY2VOYW1lLnZhbHVlLCBwbGFjZUxpbmsudmFsdWUpXHJcbiAgICAudGhlbigoYWRkZWRDYXJkKSA9PiB7XHJcbiAgICAgIGNvbnN0IG5ld1BsYWNlQ2FyZCA9IGNyZWF0ZUNhcmQoXHJcbiAgICAgICAgYWRkZWRDYXJkLFxyXG4gICAgICAgIGRlbGV0ZUNhcmQsXHJcbiAgICAgICAgbGlrZUNhcmQsXHJcbiAgICAgICAgY3VycmVudFVzZXJJZFxyXG4gICAgICApO1xyXG4gICAgICBjYXJkc09uUGFnZS5pbnNlcnRCZWZvcmUobmV3UGxhY2VDYXJkLCBjYXJkc09uUGFnZS5maXJzdENoaWxkKTtcclxuICAgICAgY29uc3QgZGVsZXRlQnV0dG9uID0gbmV3UGxhY2VDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnV0dG9uJyk7XHJcbiAgICAgIGRlbGV0ZUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICAgICAgbmV3UGxhY2UucmVzZXQoKTtcclxuICAgICAgY2xvc2VQb3B1cChwb3B1cEFkZE5ld0NhcmQpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcign0J7RiNC40LHQutCwINC/0YDQuCDQtNC+0LHQsNCy0LvQtdC90LjQuCDQutCw0YDRgtC+0YfQutC4OicsIGVycm9yKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHJlbmRlckxvYWRpbmcoZmFsc2UsIHNhdmVCdXR0b24pO1xyXG4gICAgfSk7XHJcbn1cclxuIiwiaW1wb3J0ICcuLi9wYWdlcy9pbmRleC5jc3MnO1xyXG5pbXBvcnQgeyBhZGRDYXJkcywgYWRkQ2FyZFRvQ2FyZHNBcnJheSB9IGZyb20gJy4vY2FyZC5qcyc7XHJcbmltcG9ydCB7IG9wZW5Qb3B1cCwgY2xvc2VQb3B1cCwgb3BlblBvcHVwQnlCdXR0b24gfSBmcm9tICcuL21vZGFsLmpzJztcclxuaW1wb3J0IHsgZW5hYmxlVmFsaWRhdGlvbiB9IGZyb20gJy4vdmFsaWRhdGlvbi5qcyc7XHJcbmltcG9ydCB7XHJcbiAgdXplckF1dGhvcml6YXRpb24sXHJcbiAgcHVzaE15QXV0aG9yaXphdGlvblRvU2VydmVyLFxyXG4gIGNoYW5nZU15QXZhdGFyLFxyXG4gIGNoZWNrUmVzcG9uc2UsXHJcbn0gZnJvbSAnLi9hcGkuanMnO1xyXG5cclxuYWRkQ2FyZHMoKTtcclxuXHJcbmNvbnN0IHBvcHVwUHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2VkaXQnKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwQWRkTmV3Q2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX25ldy1jYXJkJyk7XHJcbmV4cG9ydCBjb25zdCBwb3B1cEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfaW1hZ2UnKTtcclxuXHJcbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcclxuY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcclxuXHJcbmNvbnN0IHBvcHVwSW1hZ2VJbWFnZSA9IHBvcHVwSW1hZ2UucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xyXG5jb25zdCBwb3B1cEltYWdlQ2FwdGlvbiA9IHBvcHVwSW1hZ2UucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXB0aW9uJyk7XHJcblxyXG4vLyDQkdC70L7QuiDQvtGC0LLQtdGH0LDRjtGJ0LjQuSDQt9CwINGB0L7RhdGA0LDQvdC10L3QuNC1INC00LDQvdC90YvRhSDQsiBwb3B1cCAn0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjQtSDQv9GA0L7RhNC40LvRjydcclxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fdGl0bGUnKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2Rlc2NyaXB0aW9uJyk7XHJcbmNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXMuZWRpdFByb2ZpbGU7XHJcbmNvbnN0IHByb2ZpbGVGb3JtTmFtZSA9IHByb2ZpbGVGb3JtLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9uYW1lJyk7XHJcbmNvbnN0IHByb2ZpbGVGb3JtRGVzY3JpcHRpb24gPSBwcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICcucG9wdXBfX2lucHV0X3R5cGVfZGVzY3JpcHRpb24nXHJcbik7XHJcblxyXG5mdW5jdGlvbiBzZXRQcm9maWxlRm9ybVZhbHVlcygpIHtcclxuICBwcm9maWxlRm9ybU5hbWUudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcclxuICBwcm9maWxlRm9ybURlc2NyaXB0aW9uLnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xyXG4gIGNvbnN0IGlucHV0RXZlbnQgPSBuZXcgRXZlbnQoJ2lucHV0JywgeyBidWJibGVzOiB0cnVlIH0pO1xyXG4gIHByb2ZpbGVGb3JtTmFtZS5kaXNwYXRjaEV2ZW50KGlucHV0RXZlbnQpO1xyXG4gIHByb2ZpbGVGb3JtRGVzY3JpcHRpb24uZGlzcGF0Y2hFdmVudChpbnB1dEV2ZW50KTtcclxufVxyXG5cclxuZnVuY3Rpb24gb3BlblByb2ZpbGVQb3B1cEJ5QnV0dG9uKCkge1xyXG4gIHNldFByb2ZpbGVGb3JtVmFsdWVzKCk7XHJcbiAgb3BlblBvcHVwKHBvcHVwUHJvZmlsZSk7XHJcbn1cclxuXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuUHJvZmlsZVBvcHVwQnlCdXR0b24pO1xyXG5cclxuLy8g0JjQt9C80LXQvdC10L3QuNC1INC/0YDQvtGE0LjQu9GPXHJcbmZ1bmN0aW9uIGNoYW5nZVByb2ZpbGUoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGV2dC50YXJnZXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcclxuICByZW5kZXJMb2FkaW5nKHRydWUsIHNhdmVCdXR0b24pO1xyXG5cclxuICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHByb2ZpbGVGb3JtTmFtZS52YWx1ZTtcclxuICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBwcm9maWxlRm9ybURlc2NyaXB0aW9uLnZhbHVlO1xyXG4gIHB1c2hNeUF1dGhvcml6YXRpb25Ub1NlcnZlcihcclxuICAgIHByb2ZpbGVGb3JtTmFtZS52YWx1ZSxcclxuICAgIHByb2ZpbGVGb3JtRGVzY3JpcHRpb24udmFsdWVcclxuICApXHJcbiAgICAudGhlbihjaGVja1Jlc3BvbnNlKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBjbG9zZVBvcHVwKHBvcHVwUHJvZmlsZSk7XHJcbiAgICAgIHByb2ZpbGVGb3JtLnJlc2V0KCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coYNCe0YjQuNCx0LrQsDogJHtlcnJ9YCk7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICByZW5kZXJMb2FkaW5nKGZhbHNlLCBzYXZlQnV0dG9uKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5zZXRQcm9maWxlRm9ybVZhbHVlcygpO1xyXG5cclxuLy/QmNC30LzQtdC90LXQvdC40LUg0LDQstCw0YLQsNGA0LAg0YfQtdGA0LXQtyDQv9C+0L/QsNC/XHJcbmNvbnN0IHByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19pbWFnZScpO1xyXG5jb25zdCBjaGFuZ2VBdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faW1hZ2UnKTtcclxuY29uc3QgcG9wdXBDaGFuZ2VBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9uZXctYXZhdGFyJyk7XHJcbmNvbnN0IGF2YXRhckZvcm0gPSBkb2N1bWVudC5mb3Jtcy5jaGFuZ2VBdmF0YXI7XHJcbmNvbnN0IGNoYW5nZUF2YXRhckZvcm0gPSBhdmF0YXJGb3JtLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgJy5wb3B1cF9faW5wdXRfdHlwZV9hdmF0YXJfdXJsJ1xyXG4pO1xyXG5cclxuY2hhbmdlQXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gIG9wZW5Qb3B1cChwb3B1cENoYW5nZUF2YXRhcik7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gY2hhbmdlUHJvZmlsZUF2YXRhcihldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBzYXZlQnV0dG9uID0gYXZhdGFyRm9ybS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbicpO1xyXG4gIGNvbnN0IGF2YXRhclVybCA9IGNoYW5nZUF2YXRhckZvcm0udmFsdWU7XHJcbiAgcHJvZmlsZUltYWdlLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJyR7YXZhdGFyVXJsfScpYDtcclxuICByZW5kZXJMb2FkaW5nKHRydWUsIHNhdmVCdXR0b24pO1xyXG4gIGNoYW5nZU15QXZhdGFyKGF2YXRhclVybClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgY2xvc2VQb3B1cChwb3B1cENoYW5nZUF2YXRhcik7XHJcbiAgICAgIGF2YXRhckZvcm0ucmVzZXQoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ9Ce0YjQuNCx0LrQsCDQv9GA0Lgg0YHQvtGF0YDQsNC90LXQvdC40Lgg0LDQstCw0YLQsNGA0LA6JywgZXJyb3IpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcmVuZGVyTG9hZGluZyhmYWxzZSwgc2F2ZUJ1dHRvbik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLy/QodC70YPRiNCw0YLQtdC70Lgg0L3QsCDQt9Cw0LrRgNGL0YLQuNC1INGE0L7RgNC8ICsg0YHQu9GD0YjQsNGC0LXQu9GMINC/0L7RgdGC0LDQvdC+0LLQutC4INC70LDQudC60LBcclxucHJvZmlsZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgY2hhbmdlUHJvZmlsZSk7XHJcbm5ld1BsYWNlLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGFkZENhcmRUb0NhcmRzQXJyYXkpO1xyXG5hdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGNoYW5nZVByb2ZpbGVBdmF0YXIpO1xyXG5cclxuLy/QktGL0LfQvtCy0Ysg0YTRg9C90LrRhtC40Lkg0L7RgtC60YDRi9GC0LjRjyDQuCDQt9Cw0LrRgNGL0YLQuNGPINC80L7QtNCw0LvRjNC90YvRhSDQvtC60L7QvVxyXG5vcGVuUG9wdXBCeUJ1dHRvbihhZGRCdXR0b24sIHBvcHVwQWRkTmV3Q2FyZCk7XHJcblxyXG4vL9C+0YLQutGA0YvRgtC40LUg0L/QvtC/0LDQv9CwINC40LfQvtCx0YDQsNC20LXQvdC40Y9cclxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5JbWFnZVBvcHVwKGxpbmssIGFsdCkge1xyXG4gIHBvcHVwSW1hZ2VJbWFnZS5zcmMgPSBsaW5rO1xyXG4gIHBvcHVwSW1hZ2VJbWFnZS5hbHQgPSBhbHQ7XHJcbiAgcG9wdXBJbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBhbHQ7XHJcbiAgb3BlblBvcHVwKHBvcHVwSW1hZ2UpO1xyXG59XHJcblxyXG4vL9Cy0YvQt9C+0LIg0LLQsNC70LjQtNCw0YbQuNC4XHJcbmVuYWJsZVZhbGlkYXRpb24oe1xyXG4gIGZvcm1TZWxlY3RvcjogJy5wb3B1cF9fZm9ybScsXHJcbiAgaW5wdXRTZWxlY3RvcjogJy5wb3B1cF9faW5wdXQnLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19idXR0b24nLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdwb3B1cF9fYnV0dG9uX2Rpc2FibGVkJyxcclxuICBpbnB1dEVycm9yQ2xhc3M6ICdwb3B1cF9faW5wdXRfdHlwZV9lcnJvcicsXHJcbiAgZXJyb3JDbGFzczogJ3BvcHVwX19lcnJvcl92aXNpYmxlJyxcclxufSk7XHJcblxyXG4vL9GA0LDQsdC+0YLQsCDRgSDRgdC10YDQstC10YDQvtC8XHJcbnV6ZXJBdXRob3JpemF0aW9uKClcclxuICAudGhlbigodXNlckRhdGEpID0+IHtcclxuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcclxuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0O1xyXG4gICAgcHJvZmlsZUltYWdlLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IHVzZXJEYXRhLmF2YXRhcjtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ9Ce0YjQuNCx0LrQsCDQv9C+0LvRg9GH0LXQvdC40Y8g0LTQsNC90L3Ri9GFINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjzonLCBlcnJvcik7XHJcbiAgfSk7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGJ1dHRvbikge1xyXG4gIGlmIChidXR0b24gJiYgYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2J1dHRvbicpKSB7XHJcbiAgICBjb25zdCBidXR0b25UZXh0ID0gaXNMb2FkaW5nID8gJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJyA6ICfQodC+0YXRgNCw0L3QuNGC0YwnO1xyXG4gICAgYnV0dG9uLnRleHRDb250ZW50ID0gYnV0dG9uVGV4dDtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJleHBvcnRzIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiZXNjQ2FsbGJhY2siLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZXJyb3JFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbmNhdCIsImlkIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidGV4dENvbnRlbnQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsInJlbW92ZUF0dHJpYnV0ZSIsImFkZCIsInNldEF0dHJpYnV0ZSIsIm9wZW5Qb3B1cCIsInBvcHVwIiwiZXZ0IiwiY2xvc2VQb3B1cCIsImNsb3NlUG9wYXBFc2MiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiY29udGFpbnMiLCJjdXJyZW50VXNlcklkIiwiY29uZmlnIiwiYmFzZVVybCIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwiY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJsaWtlQ2FyZE9uU2VydmVyIiwiY2FyZElkIiwiZmV0Y2giLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInRoZW4iLCJkaXNMaWtlQ2FyZE9uU2VydmVyIiwiY2FyZHNPblBhZ2UiLCJjYXJkVGVtcGxhdGUiLCJjb250ZW50IiwibmV3UGxhY2UiLCJmb3JtcyIsInBsYWNlTmFtZSIsInBsYWNlTGluayIsImNyZWF0ZUNhcmQiLCJwbGFjZSIsImRlbGV0ZUZ1bmN0aW9uIiwibGlrZUZ1bmN0aW9uIiwiY2FyZEl0ZW0iLCJjbG9uZU5vZGUiLCJkZWxldGVCdXR0b24iLCJjYXJkSW1hZ2UiLCJjYXJkVGl0bGUiLCJjYXJkTGlrZUJ1dHRvbiIsIm51bWJlck9mTGlrZXMiLCJfaWQiLCJkYXRhc2V0Iiwib3duZXIiLCJzdHlsZSIsImRpc3BsYXkiLCJsaWtlcyIsInVzZXIiLCJzcmMiLCJsaW5rIiwiYWx0IiwibmFtZSIsImxlbmd0aCIsIm9wZW5JbWFnZVBvcHVwIiwiZGVsZXRlQ2FyZCIsImNhcmRUb1JlbW92ZSIsImNsb3Nlc3QiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJsaWtlQ2FyZCIsImN1cnJlbnRDYXJkIiwiY2FyZFRvTGlrZSIsImlzTGlrZWQiLCJ1cGRhdGVkQ2FyZCIsInRvZ2dsZSIsInJlc3VsdCIsImluaXRpYWxDYXJkc0Zyb21TZXJ2ZXIiLCJjYXJkIiwiYXBwZW5kQ2hpbGQiLCJwb3B1cFByb2ZpbGUiLCJwb3B1cEFkZE5ld0NhcmQiLCJwb3B1cEltYWdlIiwiZWRpdEJ1dHRvbiIsImFkZEJ1dHRvbiIsInBvcHVwSW1hZ2VJbWFnZSIsInBvcHVwSW1hZ2VDYXB0aW9uIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlRm9ybSIsImVkaXRQcm9maWxlIiwicHJvZmlsZUZvcm1OYW1lIiwicHJvZmlsZUZvcm1EZXNjcmlwdGlvbiIsInNldFByb2ZpbGVGb3JtVmFsdWVzIiwidmFsdWUiLCJpbnB1dEV2ZW50IiwiRXZlbnQiLCJidWJibGVzIiwiZGlzcGF0Y2hFdmVudCIsInByb2ZpbGVJbWFnZSIsImNoYW5nZUF2YXRhckJ1dHRvbiIsInBvcHVwQ2hhbmdlQXZhdGFyIiwiYXZhdGFyRm9ybSIsImNoYW5nZUF2YXRhciIsImNoYW5nZUF2YXRhckZvcm0iLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwiYnV0dG9uIiwiYnV0dG9uVGV4dCIsInByZXZlbnREZWZhdWx0IiwiZGVzY3JpcHRpb24iLCJzYXZlQnV0dG9uIiwiYWJvdXQiLCJyZXNldCIsImZpbmFsbHkiLCJjYXJkTmFtZSIsImNhcmRMaW5rIiwiYWRkZWRDYXJkIiwibmV3UGxhY2VDYXJkIiwiaW5zZXJ0QmVmb3JlIiwiZmlyc3RDaGlsZCIsImVycm9yIiwiYXZhdGFyVXJsIiwiYmFja2dyb3VuZEltYWdlIiwiYXZhdGFyIiwiY2hhbmdlTXlBdmF0YXIiLCJldmVudCIsInBhdHRlcm5NaXNtYXRjaCIsInNldEN1c3RvbVZhbGlkaXR5IiwiZXJyb3JNZXNzYWdlIiwic2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNldEV2ZW50TGlzdGVuZXJzIiwidXNlckRhdGEiXSwic291cmNlUm9vdCI6IiJ9